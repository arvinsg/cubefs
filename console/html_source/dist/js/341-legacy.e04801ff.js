"use strict";(self["webpackJsonp_cfs-console"]=self["webpackJsonp_cfs-console"]||[]).push([[341],{98288:function(e,t,a){var o,i,n,s,r,l,c,u,m,d,p,h,g,v,f,b,D,S,$,F,y,_,R,P=a(2106),V=a(4969),N={queryServerList:(0,V.ZP)(o||(o=(0,P.Z)(["\n    query dataNodeListTest($num: int64) {\n      dataNodeListTest(num: $num) {\n        addr\n        availableSpace\n        #      badDisks\n        carry\n        dataPartitionCount\n        #      dataPartitionReports\n        iD\n        nodeSetID\n        #      persistenceDataPartitions\n        reportTime\n        selectedTimes\n        total\n        usageRatio\n        used\n        zoneName\n      }\n    }\n  "]))),serverManagementList:(0,V.ZP)(i||(i=(0,P.Z)(["\n    query clusterView {\n      clusterView {\n        name\n        dataNodes {\n          addr\n          reportDisks\n          status\n          isWritable\n          toDataNode {\n            zoneName\n            used\n            total\n            usageRatio\n            badDisks\n          }\n        }\n        metaNodes {\n          addr\n          status\n          isWritable\n          toMetaNode {\n            zoneName\n            used\n            total\n            ratio\n          }\n        }\n      }\n    }\n  "]))),queryVolList:(0,V.ZP)(n||(n=(0,P.Z)(["\n  query volList($cluster:String,$keywords:String){\n    volList(cluster: $cluster,keywords:$keywords)\n  }\n  "]))),queryVolumeList:(0,V.ZP)(s||(s=(0,P.Z)(["\n    query listVolume($keyword: String, $userID: String) {\n      listVolume(keyword: $keyword, userID: $userID) {\n        name\n        capacity\n        occupied\n        dpReplicaNum\n        owner\n        createTime\n        oSSAccessKey\n        oSSSecretKey\n        inodeCount\n        toSimpleVolView {\n          description\n          dpCnt\n          mpCnt\n          rwDpCnt\n        }\n        status\n      }\n    }\n  "]))),createVolume:(0,V.ZP)(r||(r=(0,P.Z)(["\n    mutation createVolume(\n      $authenticate: Bool\n      $capacity: Uint64\n      $crossZone: Bool\n      $dataPartitionSize: Uint64\n      $dpReplicaNum: Uint64\n      $enableToken: Bool\n      $followerRead: Bool\n      $mpCount: Uint64\n      $name: String\n      $owner: String\n      $zoneName: String\n      $description: String\n    ) {\n      createVolume(\n        authenticate: $authenticate\n        capacity: $capacity\n        crossZone: $crossZone\n        dataPartitionSize: $dataPartitionSize\n        dpReplicaNum: $dpReplicaNum\n        enableToken: $enableToken\n        followerRead: $followerRead\n        mpCount: $mpCount\n        name: $name\n        owner: $owner\n        zoneName: $zoneName\n        description: $description\n      ) {\n        name\n      }\n    }\n  "]))),updateVolume:(0,V.ZP)(l||(l=(0,P.Z)(["\n    mutation updateVolume(\n      $authKey: String\n      $capacity: Uint64\n      $enableToken: Bool\n      $name: String\n      $replicaNum: Uint64\n      $zoneName: String\n      $description: String\n    ) {\n      updateVolume(\n        authKey: $authKey\n        capacity: $capacity\n        enableToken: $enableToken\n        name: $name\n        replicaNum: $replicaNum\n        zoneName: $zoneName\n        description: $description\n      ) {\n        name\n        capacity\n      }\n    }\n  "]))),deleteVolume:(0,V.ZP)(c||(c=(0,P.Z)(["\n    mutation deleteVolume($authKey: String, $name: String) {\n      deleteVolume(authKey: $authKey, name: $name) {\n        code\n        message\n      }\n    }\n  "]))),queryPermissionList:(0,V.ZP)(u||(u=(0,P.Z)(["\n    query volPermission($volName: String, $userID: String) {\n      volPermission(volName: $volName, userID: $userID) {\n        userID\n        access\n      }\n    }\n  "]))),grantPermission:(0,V.ZP)(m||(m=(0,P.Z)(["\n    mutation updateUserPolicy(\n      $policy: Array\n      $userID: String\n      $volume: String\n    ) {\n      updateUserPolicy(policy: $policy, userID: $userID, volume: $volume) {\n        user_id\n      }\n    }\n  "]))),deletePermission:(0,V.ZP)(d||(d=(0,P.Z)(["\n    mutation removeUserPolicy($userID: String, $volume: String) {\n      removeUserPolicy(userID: $userID, volume: $volume) {\n        user_id\n      }\n    }\n  "]))),decommissionDataNode:(0,V.ZP)(p||(p=(0,P.Z)(["\n    mutation decommissionDataNode($offLineAddr: String) {\n      decommissionDataNode(offLineAddr: $offLineAddr) {\n        code\n        message\n      }\n    }\n  "]))),decommissionMetaNode:(0,V.ZP)(h||(h=(0,P.Z)(["\n    mutation decommissionMetaNode($offLineAddr: String) {\n      decommissionMetaNode(offLineAddr: $offLineAddr) {\n        code\n        message\n      }\n    }\n  "]))),decommissionDisk:(0,V.ZP)(g||(g=(0,P.Z)(["\n    mutation decommissionDisk($offLineAddr: String, $diskPath: String) {\n      decommissionDisk(offLineAddr: $offLineAddr, diskPath: $diskPath) {\n        code\n        message\n      }\n    }\n  "]))),queryMetaPartitionList:(0,V.ZP)(v||(v=(0,P.Z)(["\n    query metaPartitionList {\n      metaPartitionList {\n        partitionID\n        dentryCount\n        start\n        end\n        hosts\n        volName\n        inodeCount\n        isRecover\n        maxInodeID\n        partitionID\n        peers {\n          iD\n          addr\n        }\n        replicaNum\n        status\n        missNodes\n      }\n    }\n  "]))),queryDataPartitionList:(0,V.ZP)(f||(f=(0,P.Z)(["\n    query dataPartitionList {\n      dataPartitionList {\n        partitionID\n        hosts\n        peers {\n          iD\n          addr\n        }\n        replicaNum\n        lastLoadedTime\n        status\n        missNodes\n        volName\n      }\n    }\n  "]))),queryMetaNodeAddrList:(0,V.ZP)(b||(b=(0,P.Z)(["\n    query clusterView {\n      clusterView {\n        metaNodes {\n          addr\n          isWritable\n          status\n          toMetaNode {\n            metaPartitionCount\n            total\n            used\n          }\n        }\n      }\n    }\n  "]))),queryDataNodeAddrList:(0,V.ZP)(D||(D=(0,P.Z)(["\n    query clusterView {\n      clusterView {\n        dataNodes {\n          addr\n          isWritable\n          status\n          toDataNode {\n            dataPartitionCount\n            total\n            used\n          }\n        }\n      }\n    }\n  "]))),addMetaReplica:(0,V.ZP)(S||(S=(0,P.Z)(["\n    mutation addMetaReplica($addr: String, $partitionID: int64) {\n      addMetaReplica(addr: $addr, partitionID: $partitionID) {\n        code\n        message\n      }\n    }\n  "]))),deleteMetaReplica:(0,V.ZP)($||($=(0,P.Z)(["\n    mutation deleteMetaReplica($addr: String, $partitionID: int64) {\n      deleteMetaReplica(addr: $addr, partitionID: $partitionID) {\n        code\n        message\n      }\n    }\n  "]))),decommissionMetaPartition:(0,V.ZP)(F||(F=(0,P.Z)(["\n    mutation decommissionMetaPartition($addr: String, $partitionID: int64) {\n      decommissionMetaPartition(addr: $addr, partitionID: $partitionID) {\n        code\n        message\n      }\n    }\n  "]))),addDataReplica:(0,V.ZP)(y||(y=(0,P.Z)(["\n    mutation addDataReplica($addr: String, $partitionID: int64) {\n      addDataReplica(addr: $addr, partitionID: $partitionID) {\n        code\n        message\n      }\n    }\n  "]))),deleteDataReplica:(0,V.ZP)(_||(_=(0,P.Z)(["\n    mutation deleteDataReplica($addr: String, $partitionID: int64) {\n      deleteDataReplica(addr: $addr, partitionID: $partitionID) {\n        code\n        message\n      }\n    }\n  "]))),decommissionDataPartition:(0,V.ZP)(R||(R=(0,P.Z)(["\n    mutation decommissionDataPartition($addr: String, $partitionID: int64) {\n      decommissionDataPartition(addr: $addr, partitionID: $partitionID) {\n        code\n        message\n      }\n    }\n  "])))};t.Z=N},69092:function(e,t,a){a.d(t,{Ur:function(){return s},b4:function(){return i},li:function(){return n}});a(60228),a(12826);function o(e){var t=null!==e?new Date(e):new Date;return{year:t.getFullYear(),month:t.getMonth(),date:t.getDate(),hour:t.getHours(),minute:t.getMinutes(),second:t.getSeconds(),milli:t.getMilliseconds()}}function i(e,t){t=t||"-";var a="[object Object]"===Object.prototype.toString.call(e)?e:o(e),i=a.month+1<10?"0"+(a.month+1):a.month+1,n=a.date<10?"0"+a.date:a.date;return a.year+t+i+t+n}function n(e,t){t=t||":";var a="[object Object]"===Object.prototype.toString.call(e)?e:o(e),i=a.hour<10?"0"+a.hour:a.hour,n=a.minute<10?"0"+a.minute:a.minute,s=a.second<10?"0"+a.second:a.second;return i+t+n+t+s}function s(e){var t=o(e),a=i(t)+" "+n(t);return a}},85353:function(e,t,a){a.d(t,{BU:function(){return r},LR:function(){return l},Ox:function(){return o},mr:function(){return i}});a(52003),a(68518),a(64043),a(13440),a(12826),a(57267),a(97389);function o(){if(0===arguments.length)return null;for(var e=arguments[0],t=1;t<arguments.length;t++){var a=new RegExp("\\{"+(t-1)+"\\}","gm");e=e.replace(a,arguments[t])}return e}function i(e,t){if(0===e)return"0 ns";if(e>6e7){var a=["min","h"],o=6e7,i=parseInt(e/o),n=i>60?1:0;return t?i+" "+a[n]:i}var s=["ns","Î¼s","ms","s"],r=1e3,l=Math.floor(Math.log(e)/Math.log(r)),c=parseInt(e/Math.pow(r,l));return t?c+" "+s[l]:c}var n=["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"],s=["iB","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"];function r(e,t){if(0===e)return"0 Bytes";var a=2===t?s:n,o=2===t?1024:1e3,i=Math.floor(Math.log(e)/Math.log(o));return parseFloat((e/Math.pow(o,i)).toFixed(3))+" "+a[i]}function l(e){return 1==e?"ReadOnly":2==e?"ReadWrite":"Unavailable"}},26341:function(e,t,a){a.r(t),a.d(t,{default:function(){return Z}});var o=function(){var e=this,t=e._self._c;return t("div",{staticClass:"operations"},[t("el-tabs",{attrs:{type:"card"},on:{"tab-click":e.handleClick},model:{value:e.operationsSelect,callback:function(t){e.operationsSelect=t},expression:"operationsSelect"}},[t("el-tab-pane",{attrs:{label:e.$t("chubaoFS.operations.ServerManagement.title"),name:"ServerManagement"}},[t("div",{staticClass:"operation-container"},[t("server-management",{ref:"childServer"})],1)]),e._v(" "),t("el-tab-pane",{attrs:{label:e.$t("chubaoFS.operations.VolumeManagement.title"),name:"VolumeManagement"}},[t("div",{staticClass:"operation-container"},[t("volume-management",{ref:"childVolume"})],1)]),e._v(" "),t("el-tab-pane",{attrs:{label:e.$t("chubaoFS.operations.MetaPartitionManagement.title"),name:"MetaPartitionManagement"}},[t("div",{staticClass:"operation-container"},[t("metaPartition-management",{ref:"childMetaPartition"})],1)]),e._v(" "),t("el-tab-pane",{attrs:{label:e.$t("chubaoFS.operations.DataPartitionManagement.title"),name:"DataPartitionManagement"}},[t("div",{staticClass:"operation-container"},[t("dataPartition-management",{ref:"childDataPartition"})],1)])],1)],1)},i=[],n=(a(34284),function(){var e=this,t=e._self._c;return t("div",{staticClass:"operation-server"},[t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.resData.loading,expression:"resData.loading"}]},[t("el-table",{staticStyle:{width:"100%"},attrs:{data:e.resData.resLists}},[t("el-table-column",{attrs:{prop:"name",label:e.$t("chubaoFS.operations.ServerManagement.Cluster")}}),e._v(" "),t("el-table-column",{attrs:{prop:"allDataNode.zoneName",label:e.$t("chubaoFS.operations.ServerManagement.IDC")}}),e._v(" "),t("el-table-column",{attrs:{prop:"addr",label:e.$t("chubaoFS.operations.ServerManagement.ServerIP")}}),e._v(" "),t("el-table-column",{attrs:{prop:"serverType",label:e.$t("chubaoFS.operations.ServerManagement.ServiceType")}}),e._v(" "),t("el-table-column",{attrs:{prop:"statusStr",label:e.$t("chubaoFS.operations.ServerManagement.Status")}}),e._v(" "),t("el-table-column",{attrs:{prop:"isWritableStr",label:e.$t("chubaoFS.operations.ServerManagement.IsWritable")}}),e._v(" "),t("el-table-column",{attrs:{prop:"allDataNode.used",label:e.$t("chubaoFS.operations.ServerManagement.UsedCapacity")}}),e._v(" "),t("el-table-column",{attrs:{prop:"allDataNode.total",label:e.$t("chubaoFS.operations.ServerManagement.TotalCapacity")}}),e._v(" "),t("el-table-column",{attrs:{prop:"allDataNode.capacityRatio",label:e.$t("chubaoFS.operations.ServerManagement.Used")}}),e._v(" "),t("el-table-column",{attrs:{label:e.$t("chubaoFS.tools.Actions"),width:"230"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{directives:[{name:"show",rawName:"v-show",value:"dataNodes"===a.row.serverType,expression:"scope.row.serverType === 'dataNodes'"}],staticClass:"text-btn",attrs:{type:"text"},on:{click:function(t){return e.openDialog("editDisk",a.row)}}},[e._v(e._s(e.$t("chubaoFS.operations.ServerManagement.OffLineDisk")))]),e._v(" "),t("el-button",{staticClass:"text-btn",attrs:{type:"text"},on:{click:function(t){return e.editServer(a.row)}}},[e._v(e._s(e.$t("chubaoFS.operations.ServerManagement.OffLineServer")))])]}}])})],1),e._v(" "),t("div",{staticClass:"clearfix mt20"},[t("el-pagination",{staticClass:"fr",attrs:{"page-sizes":e.resData.page.pageSizes,"page-size":e.resData.page.pageSize,layout:"sizes, prev, pager, next",total:e.resData.page.totalRecord},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}),e._v(" "),t("span",{staticClass:"fr page-tips pr10"},[e._v(e._s(e.$t("chubaoFS.commonTxt.eachPageShows")))])],1)],1),e._v(" "),t("el-dialog",{attrs:{title:e.$t("chubaoFS.operations.ServerManagement.OffLineDisk"),visible:e.diskDialog,width:"30%"},on:{"update:visible":function(t){e.diskDialog=t},close:function(t){return e.closeDialog()}}},[t("p",{staticClass:"mb20"},[e._v("\n      "+e._s(e.$t("chubaoFS.operations.ServerManagement.diskTip"))+"\n    ")]),e._v(" "),t("el-checkbox-group",{model:{value:e.checkList,callback:function(t){e.checkList=t},expression:"checkList"}},e._l(e.checkListVal,(function(a){return t("el-checkbox",{key:a,attrs:{label:a}},[e._v(e._s(a))])})),1),e._v(" "),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:e.closeDialog}},[e._v(e._s(e.$t("chubaoFS.tools.No")))]),e._v(" "),t("el-button",{attrs:{type:"primary"},on:{click:e.editDisk}},[e._v(e._s(e.$t("chubaoFS.tools.Yes")))])],1)],1)],1)}),s=[],r=(a(89730),a(60228),a(47522),a(12826),a(97389),a(34338),a(65137),a(85353)),l=a(98288),c={name:"OperationServer",data:function(){return{resData:{loading:!0,page:{pageSizes:[10,20,30,40],pageNo:1,pageSize:10,totalRecord:0,totalPage:1},resLists:[]},serverList:[],dataNodesList:[],metaNodesList:[],diskDialog:!1,diskData:{},checkList:[],checkListVal:[],diskTip:this.$t("chubaoFS.operations.ServerManagement.diskTip")}},methods:{handleSizeChange:function(e){this.resData.page.pageSize=e,this.resData.page.pageNo=1,this.handleCurrentChange(1)},handleCurrentChange:function(e){this.resData.page.pageNo=e;var t=(e-1)*this.resData.page.pageSize,a=e*this.resData.page.pageSize;this.resData.resLists=this.serverList.slice(t,a)},queryServerList:function(){var e=this,t=this;t.resData.loading=!0;var a={num:1e4};this.apollo.query(this.url.consoleCluster,l.Z.serverManagementList,a).then((function(a){if(t.resData.loading=!1,a.data){var o=a.data;e.dataNodesList=o.clusterView.dataNodes,e.metaNodesList=o.clusterView.metaNodes,e.dataNodesList.forEach((function(t){t.name=o.clusterView.name,t.serverType="dataNodes",t.statusStr=t.status.toString(),t.isWritableStr=t.isWritable.toString(),t.allDataNode=t.toDataNode,t.allDataNode.used=(0,r.BU)(t.toDataNode.used,10),t.allDataNode.total=(0,r.BU)(t.toDataNode.total,10),t.allDataNode.capacityRatio=(100*t.toDataNode.usageRatio).toFixed(2)+"%",e.checkListVal=t.reportDisks})),e.metaNodesList.forEach((function(e){e.name=o.clusterView.name,e.serverType="metaNodes",e.statusStr=e.status.toString(),e.isWritableStr=e.isWritable.toString(),e.allDataNode=e.toMetaNode,e.allDataNode.used=(0,r.BU)(e.toMetaNode.used,10),e.allDataNode.total=(0,r.BU)(e.toMetaNode.total,10),e.allDataNode.capacityRatio=(100*e.toMetaNode.ratio).toFixed(2)+"%"})),e.serverList=e.dataNodesList.concat(e.metaNodesList),e.serverList.sort((function(e,t){return e.status===t.status?0:t.status?-1:1})),e.resData.page.totalRecord=e.serverList.length,e.handleCurrentChange(1)}else e.$message.error(a)})).catch((function(e){t.resData.loading=!1,console.log(e)}))},openDialog:function(e,t){"editDisk"===e&&(this.diskDialog=!0,this.diskData=Object.assign({},t),0===this.checkListVal.length&&(this.diskTip=this.$t("chubaoFS.operations.ServerManagement.NoDisk")))},editDisk:function(){var e=this;0===this.checkList.length&&this.$message.error(this.$t("chubaoFS.operations.ServerManagement.NoDisk"));for(var t=0;t<this.checkList.length;t++){var a={offLineAddr:this.diskData.addr,diskPath:this.checkList[t]};this.apollo.mutation(this.url.consoleCluster,l.Z.decommissionDisk,a).then((function(t){200===t.code?(e.queryServerList(),e.diskDialog=!1,e.$message({message:e.$t("chubaoFS.message.Success"),type:"success"})):e.$message.error(t)}))}},editServer:function(e){var t=this,a={offLineAddr:e.addr};this.$confirm(this.$t("chubaoFS.operations.ServerManagement.TakeOffServerTip")+" ("+e.addr+")",this.$t("chubaoFS.operations.ServerManagement.OffLineServer"),{confirmButtonText:this.$t("chubaoFS.tools.Yes"),cancelButtonText:this.$t("chubaoFS.tools.No"),type:"warning"}).then((function(){"dataNodes"===e.serverType?t.apollo.mutation(t.url.consoleCluster,l.Z.decommissionDataNode,a).then((function(e){200===e.code?(t.queryServerList(),t.$message({message:e.data.decommissionDataNode.message,type:"success"})):t.$message.error(e)})):"metaNodes"===e.serverType&&t.apollo.mutation(t.url.consoleCluster,l.Z.decommissionMetaNode,a).then((function(e){200===e.code?(t.queryServerList(),t.$message({message:e.data.decommissionDataNode.message,type:"success"})):t.$message.error(e)}))})).catch((function(){}))},closeDialog:function(){this.diskDialog=!1,this.checkList=[]}},mounted:function(){this.queryServerList()}},u=c,m=a(1001),d=(0,m.Z)(u,n,s,!1,null,"4cf4e1b3",null),p=d.exports,h=(a(59749),a(86544),function(){var e=this,t=e._self._c;return t("div",{staticClass:"volume"},[t("div",[t("div",{staticClass:"volume-left"},[t("el-button",{attrs:{type:"primary"},on:{click:function(t){e.createVolumeDialog=!0}}},[e._v(e._s(e.$t("chubaoFS.operations.VolumeManagement.CreateVolume")))])],1),e._v(" "),t("div",{staticClass:"volume-right"},[t("span",{staticClass:"pr10"},[e._v(e._s(e.$t("chubaoFS.operations.VolumeManagement.VolumeName")))]),e._v(" "),t("el-input",{staticStyle:{width:"255px"},attrs:{placeholder:""},model:{value:e.searchVal,callback:function(t){e.searchVal=t},expression:"searchVal"}}),e._v(" "),t("el-button",{staticClass:"ml5",attrs:{type:"primary"},on:{click:e.queryVolumeList}},[e._v(e._s(e.$t("chubaoFS.tools.Search")))])],1)]),e._v(" "),t("p",{staticClass:"volume-summary mt20"},[e._v("\n    "+e._s(e.$t("chubaoFS.operations.VolumeManagement.VolumeNumber"))+" :\n    "+e._s(this.resData.page.totalRecord)+"\n    "+e._s(e.$t("chubaoFS.operations.VolumeManagement.TotalCapacity"))+" :\n    "+e._s(e.totalCapacity)+"G\n  ")]),e._v(" "),t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.resData.loading,expression:"resData.loading"}],staticClass:"data-block"},[t("el-table",{staticClass:"mt10",staticStyle:{width:"100%"},attrs:{data:e.resData.resLists}},[t("el-table-column",{attrs:{prop:"name",label:e.$t("chubaoFS.operations.VolumeManagement.Name")}}),e._v(" "),t("el-table-column",{attrs:{prop:"capacityStr",label:e.$t("chubaoFS.operations.VolumeManagement.TotalCapacity")}}),e._v(" "),t("el-table-column",{attrs:{prop:"occupiedStr",label:e.$t("chubaoFS.operations.VolumeManagement.Used")}}),e._v(" "),t("el-table-column",{attrs:{prop:"occupiedPercent",label:e.$t("chubaoFS.operations.VolumeManagement.UsedRate")}}),e._v(" "),t("el-table-column",{attrs:{prop:"inodeCount",label:e.$t("chubaoFS.operations.VolumeManagement.InodeCount")}}),e._v(" "),t("el-table-column",{attrs:{prop:"dpReplicaNum",label:e.$t("chubaoFS.operations.VolumeManagement.Replications")}}),e._v(" "),t("el-table-column",{attrs:{prop:"status",label:e.$t("chubaoFS.operations.VolumeManagement.Status"),width:"80"}}),e._v(" "),t("el-table-column",{attrs:{prop:"toSimpleVolView.dpCnt",label:e.$t("chubaoFS.operations.VolumeManagement.TotalDataPartition"),width:"85"}}),e._v(" "),t("el-table-column",{attrs:{prop:"toSimpleVolView.rwDpCnt",label:e.$t("chubaoFS.operations.VolumeManagement.AvailableDataPartition"),width:"110"}}),e._v(" "),t("el-table-column",{attrs:{prop:"toSimpleVolView.mpCnt",label:e.$t("chubaoFS.operations.VolumeManagement.TotalMetapartition"),width:"130"}}),e._v(" "),t("el-table-column",{attrs:{prop:"owner",label:e.$t("chubaoFS.operations.VolumeManagement.OwnerID")}}),e._v(" "),t("el-table-column",{attrs:{prop:"createTime",label:e.$t("chubaoFS.operations.VolumeManagement.CreateTime"),width:"145"}}),e._v(" "),t("el-table-column",{attrs:{prop:"",label:e.$t("chubaoFS.tools.Actions")},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-dropdown",{attrs:{trigger:"click",size:"medium"}},[t("span",{staticClass:"el-dropdown-link"},[e._v("\n              "+e._s(e.$t("chubaoFS.tools.Actions"))+"\n              "),t("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),e._v(" "),t("el-dropdown-menu",{staticClass:"my-dropdown",attrs:{slot:"dropdown"},slot:"dropdown"},[t("el-dropdown-item",{nativeOn:{click:function(t){return e.openDialog("extend",a.row)}}},[e._v(e._s(e.$t("chubaoFS.tools.Extend")))]),e._v(" "),t("el-dropdown-item",{nativeOn:{click:function(t){return e.openDialog("permission",a.row)}}},[e._v(e._s(e.$t("chubaoFS.tools.Permission")))]),e._v(" "),t("el-dropdown-item",{nativeOn:{click:function(t){return e.openDialog("edit",a.row)}}},[e._v(e._s(e.$t("chubaoFS.tools.Edit")))]),e._v(" "),t("el-dropdown-item",{nativeOn:{click:function(t){return e.deleteVolume(a.row)}}},[e._v(e._s(e.$t("chubaoFS.tools.Delete")))]),e._v(" "),t("el-dropdown-item",{nativeOn:{click:function(t){return e.openDialog("notes",a.row)}}},[e._v(e._s(e.$t("chubaoFS.tools.Comments")))])],1)],1)]}}])})],1),e._v(" "),t("div",{staticClass:"clearfix mt20"},[t("el-pagination",{staticClass:"fr",attrs:{"page-sizes":e.resData.page.pageSizes,"page-size":e.resData.page.pageSize,layout:"sizes, prev, pager, next",total:e.resData.page.totalRecord},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}),e._v(" "),t("span",{staticClass:"fr page-tips pr10"},[e._v(e._s(e.$t("chubaoFS.commonTxt.eachPageShows")))])],1)],1),e._v(" "),t("el-dialog",{attrs:{title:e.$t("chubaoFS.operations.VolumeManagement.CreateVolume"),visible:e.createVolumeDialog,width:"35%"},on:{"update:visible":function(t){e.createVolumeDialog=t},close:function(t){return e.closeDialog("create")}}},[t("el-form",{ref:"createVolumeForm",attrs:{"label-position":e.labelPosition,model:e.createVolumeForm,rules:e.rules}},[t("el-form-item",{attrs:{label:e.$t("chubaoFS.operations.VolumeManagement.VolumeName"),prop:"name",rules:[{required:!0,message:e.$t("chubaoFS.volume.EnterNameTip"),trigger:"blur"},{validator:e.checkVolName,message:e.$t("chubaoFS.volume.NameRulesTip"),trigger:"blur"}]}},[t("el-input",{model:{value:e.createVolumeForm.name,callback:function(t){e.$set(e.createVolumeForm,"name",t)},expression:"createVolumeForm.name"}})],1),e._v(" "),t("el-form-item",{attrs:{label:e.$t("chubaoFS.operations.VolumeManagement.TotalCapacity"),prop:"totalCapacity",rules:[{required:!0,message:e.$t("chubaoFS.volume.EnterCapacityTip"),trigger:"blur"},{validator:e.checkNumber,message:e.$t("chubaoFS.volume.CapacityRules"),trigger:"blur"}]}},[t("el-input",{model:{value:e.createVolumeForm.totalCapacity,callback:function(t){e.$set(e.createVolumeForm,"totalCapacity",t)},expression:"createVolumeForm.totalCapacity"}})],1),e._v(" "),t("el-form-item",{attrs:{label:e.$t("chubaoFS.operations.VolumeManagement.OwnerID"),prop:"owner",rules:[{required:!0,message:e.$t("chubaoFS.operations.VolumeManagement.ownerMsg"),trigger:"blur"},{validator:e.checkOwnerId,message:e.$t("chubaoFS.operations.VolumeManagement.checkOwnerIdTip"),trigger:"blur"}]}},[t("el-input",{model:{value:e.createVolumeForm.owner,callback:function(t){e.$set(e.createVolumeForm,"owner",t)},expression:"createVolumeForm.owner"}})],1),e._v(" "),t("el-form-item",{attrs:{label:e.$t("chubaoFS.operations.VolumeManagement.ZoneName"),prop:"zoneName"}},[t("el-input",{model:{value:e.createVolumeForm.zoneName,callback:function(t){e.$set(e.createVolumeForm,"zoneName",t)},expression:"createVolumeForm.zoneName"}})],1),e._v(" "),t("el-form-item",{attrs:{label:e.$t("chubaoFS.tools.Comments"),prop:"notes"}},[t("el-input",{attrs:{type:"textarea"},model:{value:e.createVolumeForm.notes,callback:function(t){e.$set(e.createVolumeForm,"notes",t)},expression:"createVolumeForm.notes"}})],1)],1),e._v(" "),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.closeDialog("create")}}},[e._v(e._s(e.$t("chubaoFS.tools.Cancel")))]),e._v(" "),t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.createVolume("createVolumeForm")}}},[e._v(e._s(e.$t("chubaoFS.tools.Create")))])],1)],1),e._v(" "),t("el-dialog",{attrs:{title:e.$t("chubaoFS.operations.VolumeManagement.EditVolume"),visible:e.editVolumeDialog,width:"35%"},on:{"update:visible":function(t){e.editVolumeDialog=t}}},[t("el-form",{attrs:{"label-position":e.labelPosition,model:e.editVolumeForm}},[t("el-form-item",{attrs:{label:e.$t("chubaoFS.tools.Comments")}},[t("el-input",{attrs:{type:"textarea"},model:{value:e.desContent,callback:function(t){e.desContent=t},expression:"desContent"}})],1)],1),e._v(" "),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary"},on:{click:function(t){e.editVolumeDialog=!1}}},[e._v(e._s(e.$t("chubaoFS.tools.Cancel")))]),e._v(" "),t("el-button",{attrs:{type:"primary"},on:{click:e.updateVolume}},[e._v(e._s(e.$t("chubaoFS.tools.Update")))])],1)],1),e._v(" "),t("el-dialog",{attrs:{title:e.$t("chubaoFS.tools.Comments"),visible:e.notesDialog,width:"35%"},on:{"update:visible":function(t){e.notesDialog=t}}},[t("div",{staticClass:"pl10"},[e._v(e._s(e.description))]),e._v(" "),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary"},on:{click:function(t){e.notesDialog=!1}}},[e._v("OK")])],1)]),e._v(" "),t("el-dialog",{attrs:{title:e.$t("chubaoFS.operations.VolumeManagement.IncreaseVolumeCapacity"),visible:e.volumeExtensionDialog,width:"35%"},on:{"update:visible":function(t){e.volumeExtensionDialog=t},close:function(t){return e.closeDialog("extend")}}},[t("el-form",{attrs:{"label-position":e.labelPosition,model:e.editVolumeForm}},[t("el-form-item",{attrs:{label:e.$t("chubaoFS.operations.VolumeManagement.VolumeName")}},[t("el-input",{attrs:{type:"text",disabled:""},model:{value:e.editVolumeForm.name,callback:function(t){e.$set(e.editVolumeForm,"name",t)},expression:"editVolumeForm.name"}})],1),e._v(" "),t("el-form-item",{attrs:{label:e.$t("chubaoFS.operations.VolumeManagement.CurrentCapacity")}},[t("el-input",{attrs:{type:"text",disabled:""},model:{value:e.editVolumeForm.capacity,callback:function(t){e.$set(e.editVolumeForm,"capacity",t)},expression:"editVolumeForm.capacity"}})],1),e._v(" "),t("el-form-item",{attrs:{label:e.$t("chubaoFS.operations.VolumeManagement.Extendto")}},[t("el-input",{attrs:{type:"text"},model:{value:e.extendCapacity,callback:function(t){e.extendCapacity=t},expression:"extendCapacity"}})],1)],1),e._v(" "),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.closeDialog("extend")}}},[e._v(e._s(e.$t("chubaoFS.tools.Cancel")))]),e._v(" "),t("el-button",{attrs:{type:"primary"},on:{click:e.extendVolume}},[e._v(e._s(e.$t("chubaoFS.tools.Extend")))])],1)],1),e._v(" "),t("el-dialog",{attrs:{title:e.$t("chubaoFS.operations.VolumeManagement.PermissionofVolume_Spark"),visible:e.permissionDialog,width:"35%"},on:{"update:visible":function(t){e.permissionDialog=t}}},[t("el-button",{attrs:{type:"primary"},on:{click:e.openGrantPermission}},[e._v(e._s(e.$t("chubaoFS.operations.VolumeManagement.GrantPerimssion")))]),e._v(" "),t("el-table",{staticClass:"mt10",staticStyle:{width:"100%"},attrs:{data:e.permissionList}},[t("el-table-column",{attrs:{prop:"userID",label:e.$t("chubaoFS.commonAttr.UserName")}}),e._v(" "),t("el-table-column",{attrs:{prop:"access",label:e.$t("chubaoFS.operations.VolumeManagement.Access")}}),e._v(" "),t("el-table-column",{attrs:{prop:"",label:e.$t("chubaoFS.tools.Operations")},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{staticClass:"text-btn",attrs:{type:"text"},on:{click:function(t){return e.openEditPermission(a.row)}}},[e._v(e._s(e.$t("chubaoFS.tools.Edit")))]),e._v(" "),t("el-button",{staticClass:"text-btn",attrs:{type:"text"},on:{click:function(t){return e.deletePermission(a.row)}}},[e._v(e._s(e.$t("chubaoFS.tools.Remove")))])]}}])})],1)],1),e._v(" "),t("el-dialog",{attrs:{title:e.$t("chubaoFS.operations.VolumeManagement.GrantPermissionto"),visible:e.grantPermissionDialog,width:"35%"},on:{"update:visible":function(t){e.grantPermissionDialog=t},close:function(t){return e.closeDialog("grantPer")}}},[t("el-form",{ref:"grantPermissionForm",attrs:{"label-position":e.labelPosition,model:e.grantPermissionForm,rules:e.permissionRules}},[t("el-form-item",{attrs:{label:e.$t("chubaoFS.commonAttr.UserName"),prop:"userName"}},[t("el-input",{model:{value:e.grantPermissionForm.userName,callback:function(t){e.$set(e.grantPermissionForm,"userName",t)},expression:"grantPermissionForm.userName"}})],1),e._v(" "),t("el-form-item",{attrs:{label:e.$t("chubaoFS.operations.VolumeManagement.Access"),prop:"access"}},[t("el-select",{staticStyle:{width:"100%"},model:{value:e.grantPermissionForm.access,callback:function(t){e.$set(e.grantPermissionForm,"access",t)},expression:"grantPermissionForm.access"}},e._l(e.accessList,(function(e,a){return t("el-option",{key:a,attrs:{value:a,label:e}})})),1)],1)],1),e._v(" "),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.closeDialog("grantPer")}}},[e._v(e._s(e.$t("chubaoFS.tools.No")))]),e._v(" "),t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.grantPermission("grantPermissionForm")}}},[e._v(e._s(e.$t("chubaoFS.tools.Yes")))])],1)],1),e._v(" "),t("el-dialog",{attrs:{title:e.$t("chubaoFS.operations.VolumeManagement.EditUserAccess"),visible:e.editPermissionDialog,width:"35%"},on:{"update:visible":function(t){e.editPermissionDialog=t}}},[t("el-form",{ref:"grantPermissionForm",attrs:{"label-position":e.labelPosition,model:e.editPermissionForm}},[t("el-form-item",{attrs:{label:e.$t("chubaoFS.commonAttr.UserName"),prop:"userName"}},[t("el-input",{attrs:{disabled:""},model:{value:e.editPermissionForm.userID,callback:function(t){e.$set(e.editPermissionForm,"userID",t)},expression:"editPermissionForm.userID"}})],1),e._v(" "),t("el-form-item",{attrs:{label:e.$t("chubaoFS.operations.VolumeManagement.Access"),prop:"access"}},[t("el-select",{staticStyle:{width:"100%"},model:{value:e.editPermissionForm.access,callback:function(t){e.$set(e.editPermissionForm,"access",t)},expression:"editPermissionForm.access"}},e._l(e.accessList,(function(e,a){return t("el-option",{key:a,attrs:{value:a,label:e}})})),1)],1)],1),e._v(" "),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.closeDialog("editPer")}}},[e._v(e._s(e.$t("chubaoFS.tools.No")))]),e._v(" "),t("el-button",{attrs:{type:"primary"},on:{click:e.editPermission}},[e._v(e._s(e.$t("chubaoFS.tools.Yes")))])],1)],1)],1)}),g=[],v=(a(28436),a(70560),a(64043),a(57267),a(6203),a(7409),a(21057),a(69092)),f={name:"volumeManagement",data:function(){return{labelPosition:"top",searchVal:"",volumeList:[],resData:{loading:!0,page:{pageSizes:[10,20,30,40],pageNo:1,pageSize:10,totalRecord:0,totalPage:1},resLists:[]},totalCapacity:null,createVolumeDialog:!1,notesDialog:!1,editVolumeDialog:!1,volumeExtensionDialog:!1,permissionDialog:!1,grantPermissionDialog:!1,editPermissionDialog:!1,createVolumeForm:{name:"",totalCapacity:null,dpReplicaNum:null,owner:"",zoneName:"",notes:""},dpReplicaNumList:["2","3"],extendCapacity:null,rules:{dpReplicaNum:[{required:!0,message:this.$t("chubaoFS.operations.VolumeManagement.dpReplicaNumMsg"),trigger:"change"}],owner:[{required:!0,message:this.$t("chubaoFS.operations.VolumeManagement.ownerMsg"),trigger:"blur"}],notes:[{required:!0,message:this.$t("chubaoFS.operations.VolumeManagement.notesMsg"),trigger:"blur"}]},editVolumeForm:{},permissionList:[],grantPermissionForm:{userName:"",access:""},editPermissionForm:{},volName:"",accessList:this.$t("chubaoFS.accessList"),permissionRules:{userName:[{required:!0,message:this.$t("chubaoFS.operations.VolumeManagement.userNameMsg"),trigger:"blur"}],access:[{required:!0,message:this.$t("chubaoFS.operations.VolumeManagement.accessMsg"),trigger:"change"}]},permissionItem:null,description:"",desContent:""}},methods:{handleSizeChange:function(e){this.resData.page.pageSize=e,this.resData.page.pageNo=1,this.handleCurrentChange(1)},handleCurrentChange:function(e){this.resData.page.pageNo=e;var t=(e-1)*this.resData.page.pageSize,a=e*this.resData.page.pageSize;this.resData.resLists=this.volumeList.slice(t,a)},queryVolumeList:function(){var e=this;this.resData.loading=!0;var t={keyword:"",userID:this.userID,num:1e4};this.apollo.query(this.url.volume,l.Z.queryVolumeList,t).then((function(t){if(e.resData.loading=!1,t.data){var a=[];e.searchVal&&""!==e.searchVal.trim()?t.data.listVolume.forEach((function(t){t.name.indexOf(e.searchVal.trim())>-1&&a.push(t)})):a=t.data.listVolume,a.sort((function(e,t){return t.createTime-e.createTime})),e.volumeList=a,e.resData.page.totalRecord=t.data.listVolume.length,e.handleCurrentChange(1),e.totalCapacity=0,e.volumeList.forEach((function(t){e.totalCapacity+=t.capacity,t.occupiedPercent=(t.occupied/1024/1024/1024/t.capacity*100).toFixed(2)+"%",t.capacityStr=t.capacity+"G",t.occupiedStr=(t.occupied/1024/1024/1024).toFixed(4)+"G",e.accessKey=t.oSSAccessKey,e.secretKey=t.oSSSecretKey,t.createTime&&(t.createTime=1e3*t.createTime),t.createTime=(0,v.b4)(t.createTime,"-")+" "+(0,v.li)(t.createTime,":")}))}else e.$message.error(t)})).catch((function(t){e.resData.loading=!1,console.log(t)}))},createVolume:function(e){var t=this;this.$refs[e].validate((function(e){if(!e)return!1;var a={authenticate:!1,capacity:parseInt(t.createVolumeForm.totalCapacity),crossZone:!1,dataPartitionSize:0,dpReplicaNum:3,enableToken:!1,followerRead:!1,mpCount:0,name:t.createVolumeForm.name,owner:t.createVolumeForm.owner,zoneName:t.createVolumeForm.zoneName,description:t.createVolumeForm.notes};t.apollo.mutation(t.url.volume,l.Z.createVolume,a).then((function(e){200===e.code?(t.createVolumeDialog=!1,t.queryVolumeList(),t.$message({message:t.$t("chubaoFS.message.Success"),type:"success"})):t.$message.error(e)}))}))},updateVolume:function(){var e=this,t={authKey:this.md5(this.editVolumeForm.owner),name:this.editVolumeForm.name,replicaNum:parseInt(this.editVolumeForm.dpReplicaNum),description:this.desContent};t.replicaNum>this.editRow.dpReplicaNum?this.$message.error(this.$t("chubaoFS.operations.VolumeManagement.updateVolumeError")):this.apollo.mutation(this.url.volume,l.Z.updateVolume,t).then((function(t){200===t.code?(e.queryVolumeList(),e.editVolumeDialog=!1,e.$message({message:e.$t("chubaoFS.message.Success"),type:"success"})):e.$message.error(t)}))},extendVolume:function(){var e=this,t={authKey:this.md5(this.editVolumeForm.owner),name:this.editVolumeForm.name,capacity:parseInt(this.extendCapacity)};if(t.capacity<this.editVolumeForm.capacity){var a=this.$t("chubaoFS.operations.VolumeManagement.extendVolumeError");return a.replace("capacityVal",t.capacity).replace("oldCapacityVal",this.editVolumeForm.capacity),void this.$message.error(a)}this.apollo.mutation(this.url.volume,l.Z.updateVolume,t).then((function(t){200===t.code?(e.queryVolumeList(),e.extendCapacity=null,e.volumeExtensionDialog=!1,e.$message({message:e.$t("chubaoFS.message.Success"),type:"success"})):e.$message.error(t)}))},deleteVolume:function(e){var t=this,a={authKey:this.md5(e.owner),name:e.name};this.$confirm(this.$t("chubaoFS.operations.VolumeManagement.deleteVolTip")+" ("+e.name+")",this.$t("chubaoFS.tools.Warning"),{confirmButtonText:this.$t("chubaoFS.tools.Yes"),cancelButtonText:this.$t("chubaoFS.tools.No"),type:"warning"}).then((function(){t.apollo.mutation(t.url.volume,l.Z.deleteVolume,a).then((function(e){200===e.code?(t.queryVolumeList(),t.$message({message:t.$t("chubaoFS.message.Success"),type:"success"})):t.$message.error(e)}))})).catch((function(){}))},queryPermissionList:function(){var e=this;this.resData.loading=!0;var t={volName:this.permissionItem.name,userID:this.permissionItem.owner};this.apollo.query(this.url.volume,l.Z.queryPermissionList,t).then((function(t){e.resData.loading=!1,t&&(e.permissionList=t.data.volPermission)})).catch((function(t){e.resData.loading=!1,e.$Message.error(t)}))},grantPermission:function(e){var t=this;this.$refs[e].validate((function(e){if(!e)return!1;var a={policy:[t.grantPermissionForm.access],userID:t.grantPermissionForm.userName,volume:t.permissionItem.name};t.apollo.mutation(t.url.user,l.Z.grantPermission,a).then((function(e){200===e.code?(t.grantPermissionDialog=!1,t.queryPermissionList(),t.$message({message:t.$t("chubaoFS.message.Success"),type:"success"})):t.$message.error(e)}))}))},editPermission:function(){var e=this,t={policy:[this.editPermissionForm.access],userID:this.editPermissionForm.userID,volume:this.permissionItem.name};this.apollo.mutation(this.url.user,l.Z.grantPermission,t).then((function(t){200===t.code?(e.editPermissionDialog=!1,e.queryPermissionList(),e.$message({message:e.$t("chubaoFS.message.Success"),type:"success"})):e.$message.error(t)}))},deletePermission:function(e){var t=this,a={userID:e.userID,volume:this.permissionItem.name};this.$confirm(this.$t("chubaoFS.operations.VolumeManagement.deletePermTip"),this.$t("chubaoFS.tools.Warning"),{confirmButtonText:this.$t("chubaoFS.tools.Yes"),cancelButtonText:this.$t("chubaoFS.tools.No"),type:"warning"}).then((function(){t.apollo.mutation(t.url.user,l.Z.deletePermission,a).then((function(e){200===e.code?(t.queryPermissionList(),t.$message({message:t.$t("chubaoFS.message.Success"),type:"success"})):t.$message.error(e)}))})).catch((function(){}))},openGrantPermission:function(){this.grantPermissionDialog=!0},openEditPermission:function(e){this.editPermissionDialog=!0,this.editPermissionForm=Object.assign({},e),this.editPermissionForm.access=this.editPermissionForm.access.join(",")},openDialog:function(e,t){"createVolume"===e&&(this.createVolumeDialog=!0),"edit"===e&&(this.editVolumeDialog=!0,this.editVolumeForm=Object.assign({},t),this.desContent=this.editVolumeForm.toSimpleVolView.description,this.editRow=t),"notes"===e&&(this.notesDialog=!0,this.editVolumeForm=Object.assign({},t),this.description=this.editVolumeForm.toSimpleVolView.description),"extend"===e&&(this.volumeExtensionDialog=!0,this.editVolumeForm=Object.assign({},t)),"permission"===e&&(this.permissionDialog=!0,this.permissionItem=t,this.queryPermissionList(t))},closeDialog:function(e){"create"===e&&(this.createVolumeDialog=!1,this.createVolumeForm={},this.$refs["createVolumeForm"].resetFields()),"extend"===e&&(this.volumeExtensionDialog=!1,this.extendCapacity=null),"grantPer"===e&&(this.grantPermissionDialog=!1,this.grantPermissionForm={},this.$refs["grantPermissionForm"].resetFields()),"editPer"===e&&(this.editPermissionDialog=!1)},checkNumber:function(e,t,a){if(!/(^[1-9]\d*$)/.test(t))return a(new Error(this.$t("chubaoFS.enterRules.checkNumberTip")));a()},checkVolName:function(e,t,a){if(!/(^[a-z0-9]{1}[a-z0-9\\-]{1,61}[a-z0-9]$)/.test(t))return a(new Error(this.$t("chubaoFS.operations.VolumeManagement.checkVolNameTip")));a()},checkOwnerId:function(e,t,a){if(!/(^[A-Za-z][A-Za-z0-9_]{0,20}$)/.test(t))return a(new Error(this.$t("chubaoFS.operations.VolumeManagement.checkOwnerIdTip")));a()}},mounted:function(){}},b=f,D=(0,m.Z)(b,h,g,!1,null,"19dfaa26",null),S=D.exports,$=function(){var e=this,t=e._self._c;return t("div",{staticClass:"mp"},[t("div",[t("div",{staticClass:"partition-right"},[t("el-input",{staticStyle:{width:"255px"},attrs:{placeholder:""},model:{value:e.searchVal,callback:function(t){e.searchVal=t},expression:"searchVal"}}),e._v(" "),t("el-button",{staticClass:"ml5",attrs:{type:"primary"},on:{click:e.queryMetaPartitionList}},[e._v(e._s(e.$t("chubaoFS.tools.Search")))])],1)]),e._v(" "),t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.resData.loading,expression:"resData.loading"}],staticClass:"data-block"},[t("el-table",{staticClass:"mt10",staticStyle:{width:"100%"},attrs:{data:e.resData.resLists}},[t("el-table-column",{attrs:{prop:"partitionID",label:e.$t("chubaoFS.operations.MetaPartitionManagement.PartitionID")}}),e._v(" "),t("el-table-column",{attrs:{prop:"dentryCount",label:e.$t("chubaoFS.operations.MetaPartitionManagement.dentryCount")}}),e._v(" "),t("el-table-column",{attrs:{prop:"inodeCount",label:e.$t("chubaoFS.operations.MetaPartitionManagement.inodeCount")}}),e._v(" "),t("el-table-column",{attrs:{prop:"isRecover",label:e.$t("chubaoFS.operations.MetaPartitionManagement.isRecover")}}),e._v(" "),t("el-table-column",{attrs:{prop:"replicaNum",label:e.$t("chubaoFS.operations.MetaPartitionManagement.replicaNum")}}),e._v(" "),t("el-table-column",{attrs:{prop:"status",label:e.$t("chubaoFS.operations.MetaPartitionManagement.status")}}),e._v(" "),t("el-table-column",{attrs:{prop:"missNodes",label:e.$t("chubaoFS.operations.MetaPartitionManagement.missNodes")}}),e._v(" "),t("el-table-column",{attrs:{prop:"volName",label:e.$t("chubaoFS.operations.MetaPartitionManagement.VolName")}}),e._v(" "),t("el-table-column",{attrs:{prop:"start",label:e.$t("chubaoFS.operations.MetaPartitionManagement.start")}}),e._v(" "),t("el-table-column",{attrs:{prop:"end",label:e.$t("chubaoFS.operations.MetaPartitionManagement.end")}}),e._v(" "),t("el-table-column",{attrs:{prop:"",label:e.$t("chubaoFS.tools.Actions")},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-dropdown",{attrs:{trigger:"click",size:"medium"}},[t("span",{staticClass:"el-dropdown-link"},[e._v("\n              "+e._s(e.$t("chubaoFS.tools.Replica"))+"\n              "),t("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),e._v(" "),t("el-dropdown-menu",{staticClass:"my-dropdown",attrs:{slot:"dropdown"},slot:"dropdown"},[t("el-dropdown-item",{nativeOn:{click:function(t){return e.openDialog("addReplica",a.row)}}},[e._v(e._s(e.$t("chubaoFS.tools.Add")))]),e._v(" "),t("el-dropdown-item",{nativeOn:{click:function(t){return e.openDialog("deleteReplica",a.row)}}},[e._v(e._s(e.$t("chubaoFS.tools.Delete")))]),e._v(" "),t("el-dropdown-item",{nativeOn:{click:function(t){return e.openDialog("decommissionReplica",a.row)}}},[e._v(e._s(e.$t("chubaoFS.tools.Decommission")))])],1)],1)]}}])})],1),e._v(" "),t("div",{staticClass:"clearfix mt20"},[t("el-pagination",{staticClass:"fr",attrs:{"page-sizes":e.resData.page.pageSizes,"page-size":e.resData.page.pageSize,layout:"sizes, prev, pager, next",total:e.resData.page.totalRecord},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}),e._v(" "),t("span",{staticClass:"fr page-tips pr10"},[e._v(e._s(e.$t("chubaoFS.commonTxt.eachPageShows")))])],1)],1),e._v(" "),t("el-dialog",{attrs:{title:e.$t("chubaoFS.operations.MetaPartitionManagement.AddReplica"),visible:e.addReplicaDialog,width:"35%"},on:{"update:visible":function(t){e.addReplicaDialog=t},close:function(t){return e.closeDialog("addReplica")}}},[t("el-form",{attrs:{"label-position":e.labelPosition,model:e.ReplicaForm}},[t("el-form-item",{attrs:{label:e.$t("chubaoFS.operations.MetaPartitionManagement.PartitionID")}},[t("el-input",{attrs:{type:"text",disabled:""},model:{value:e.ReplicaForm.partitionID,callback:function(t){e.$set(e.ReplicaForm,"partitionID",t)},expression:"ReplicaForm.partitionID"}})],1),e._v(" "),t("el-form-item",{attrs:{label:e.$t("chubaoFS.operations.MetaPartitionManagement.Hosts")}},[t("el-select",{staticStyle:{width:"100%"},model:{value:e.ReplicaForm.addr,callback:function(t){e.$set(e.ReplicaForm,"addr",t)},expression:"ReplicaForm.addr"}},e._l(e.metaNodes,(function(e){return t("el-option",{key:e.addr,attrs:{value:e.addr,label:e.addr+" num:["+e.toMetaNode.metaPartitionCount+"] free:["+(e.toMetaNode.total-e.toMetaNode.used)+"]"}})})),1)],1)],1),e._v(" "),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.closeDialog("addReplica")}}},[e._v(e._s(e.$t("chubaoFS.tools.Cancel")))]),e._v(" "),t("el-button",{attrs:{type:"primary"},on:{click:e.addReplica}},[e._v(e._s(e.$t("chubaoFS.tools.Yes")))])],1)],1),e._v(" "),t("el-dialog",{attrs:{title:e.$t("chubaoFS.operations.MetaPartitionManagement.DeleteReplica"),visible:e.deleteReplicaDialog,width:"35%"},on:{"update:visible":function(t){e.deleteReplicaDialog=t},close:function(t){return e.closeDialog("deleteReplica")}}},[t("el-form",{attrs:{"label-position":e.labelPosition,model:e.ReplicaForm}},[t("el-form-item",{attrs:{label:e.$t("chubaoFS.operations.MetaPartitionManagement.PartitionID")}},[t("el-input",{attrs:{type:"text",disabled:""},model:{value:e.ReplicaForm.partitionID,callback:function(t){e.$set(e.ReplicaForm,"partitionID",t)},expression:"ReplicaForm.partitionID"}})],1),e._v(" "),t("el-form-item",{attrs:{label:e.$t("chubaoFS.operations.MetaPartitionManagement.Hosts")}},[t("el-select",{staticStyle:{width:"100%"},model:{value:e.ReplicaForm.addr,callback:function(t){e.$set(e.ReplicaForm,"addr",t)},expression:"ReplicaForm.addr"}},e._l(e.currentHosts,(function(e){return t("el-option",{key:e,attrs:{value:e,label:e}})})),1)],1)],1),e._v(" "),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.closeDialog("deleteReplica")}}},[e._v(e._s(e.$t("chubaoFS.tools.Cancel")))]),e._v(" "),t("el-button",{attrs:{type:"primary"},on:{click:e.deleteReplica}},[e._v(e._s(e.$t("chubaoFS.tools.Yes")))])],1)],1),e._v(" "),t("el-dialog",{attrs:{title:e.$t("chubaoFS.operations.MetaPartitionManagement.DecommissionReplica"),visible:e.decommissionReplicaDialog,width:"35%"},on:{"update:visible":function(t){e.decommissionReplicaDialog=t},close:function(t){return e.closeDialog("decommissionReplica")}}},[t("el-form",{attrs:{"label-position":e.labelPosition,model:e.ReplicaForm}},[t("el-form-item",{attrs:{label:e.$t("chubaoFS.operations.MetaPartitionManagement.PartitionID")}},[t("el-input",{attrs:{type:"text",disabled:""},model:{value:e.ReplicaForm.partitionID,callback:function(t){e.$set(e.ReplicaForm,"partitionID",t)},expression:"ReplicaForm.partitionID"}})],1),e._v(" "),t("el-form-item",{attrs:{label:e.$t("chubaoFS.operations.MetaPartitionManagement.Hosts")}},[t("el-select",{staticStyle:{width:"100%"},model:{value:e.ReplicaForm.addr,callback:function(t){e.$set(e.ReplicaForm,"addr",t)},expression:"ReplicaForm.addr"}},e._l(e.currentHosts,(function(e){return t("el-option",{key:e,attrs:{value:e,label:e}})})),1)],1)],1),e._v(" "),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.closeDialog("decommissionReplica")}}},[e._v(e._s(e.$t("chubaoFS.tools.Cancel")))]),e._v(" "),t("el-button",{attrs:{type:"primary"},on:{click:e.decommissionReplica}},[e._v(e._s(e.$t("chubaoFS.tools.Yes")))])],1)],1)],1)},F=[],y={name:"metaPartitionManagement",data:function(){return{labelPosition:"top",metaPartitionList:[],resData:{loading:!0,page:{pageSizes:[10,20,30,40],pageNo:1,pageSize:10,totalRecord:0,totalPage:1},resLists:[]},searchVal:"",addReplicaDialog:!1,deleteReplicaDialog:!1,decommissionReplicaDialog:!1,currentHosts:[],metaNodes:[],ReplicaForm:{partitionID:0,addr:""}}},methods:{handleSizeChange:function(e){this.resData.page.pageSize=e,this.resData.page.pageNo=1,this.handleCurrentChange(1)},handleCurrentChange:function(e){this.resData.page.pageNo=e;var t=(e-1)*this.resData.page.pageSize,a=e*this.resData.page.pageSize;this.resData.resLists=this.metaPartitionList.slice(t,a)},queryMetaPartitionList:function(){var e=this;this.resData.loading=!0;var t={keyword:"",userID:this.userID,num:1e4};this.apollo.query(this.url.consoleCluster,l.Z.queryMetaPartitionList,t).then((function(t){if(e.resData.loading=!1,t.data){var a=[];e.searchVal&&""!==e.searchVal.trim()?t.data.metaPartitionList.forEach((function(t){t.partitionID.toString()!=e.searchVal.trim()&&t.volName!=e.searchVal.trim()||a.push(t)})):a=t.data.metaPartitionList,a.sort((function(e,t){var a=e.peers.length!=e.replicaNum,o=t.peers.length!=t.replicaNum;return a||o?a?o?e.partitionID-t.partitionID:-1:1:0})),e.metaPartitionList=a,e.resData.page.totalRecord=e.metaPartitionList.length,e.handleCurrentChange(1),e.totalCapacity=0,e.metaPartitionList.forEach((function(e){e.status=(0,r.LR)(e.status),e.isRecover=e.isRecover.toString(),e.replicaNum=e.replicaNum+"/"+e.peers.length,void 0==e.missNodes||null==e.missNodes||0==e.missNodes.length?e.missNodes="none":e.missNodes=e.missNodes.toString()}))}else e.$message.error(t)})).catch((function(t){e.resData.loading=!1,console.log(t)}))},queryMetaNodeList:function(){var e=this;this.resData.loading=!0;var t={userID:this.userID};this.apollo.query(this.url.consoleCluster,l.Z.queryMetaNodeAddrList,t).then((function(t){e.resData.loading=!1;var a={};if(e.currentHosts.forEach((function(e){a[e]=!0})),t.data){var o=[];t.data.clusterView.metaNodes.forEach((function(e){!a[e.addr]&&e.status&&o.push(e)})),o.sort((function(e,t){return t.toMetaNode.metaPartitionCount-e.toMetaNode.metaPartitionCount})),e.metaNodes=o}else e.$message.error(t)})).catch((function(t){e.resData.loading=!1,console.log(t)}))},openDialog:function(e,t){"addReplica"===e?(this.addReplicaDialog=!0,this.ReplicaForm.partitionID=t.partitionID,this.currentHosts=t.hosts,this.ReplicaForm.addr="",this.queryMetaNodeList()):"deleteReplica"==e?(this.deleteReplicaDialog=!0,this.ReplicaForm.partitionID=t.partitionID,this.currentHosts=t.hosts,this.ReplicaForm.addr=""):"decommissionReplica"==e&&(this.decommissionReplicaDialog=!0,this.ReplicaForm.partitionID=t.partitionID,this.currentHosts=t.hosts,this.ReplicaForm.addr="")},closeDialog:function(e){"addReplica"===e?(this.addReplicaDialog=!1,this.ReplicaForm.addr="",this.ReplicaForm.partitionID=0):"deleteReplica"==e?(this.deleteReplicaDialog=!1,this.ReplicaForm.addr="",this.ReplicaForm.partitionID=0):"decommissionReplica"==e&&(this.decommissionReplicaDialog=!1,this.ReplicaForm.addr="",this.ReplicaForm.partitionID=0)},addReplica:function(){var e=this,t={partitionID:this.ReplicaForm.partitionID,addr:this.ReplicaForm.addr};this.apollo.mutation(this.url.consoleCluster,l.Z.addMetaReplica,t).then((function(t){200===t.code?(e.queryMetaPartitionList(),e.$message({message:e.$t("chubaoFS.message.Success"),type:"success"}),e.closeDialog("addReplica")):e.$message.error(t)}))},deleteReplica:function(){var e=this,t={partitionID:this.ReplicaForm.partitionID,addr:this.ReplicaForm.addr};this.apollo.mutation(this.url.consoleCluster,l.Z.deleteMetaReplica,t).then((function(t){200===t.code?(e.queryMetaPartitionList(),e.$message({message:e.$t("chubaoFS.message.Success"),type:"success"}),e.closeDialog("deleteReplica")):e.$message.error(t)}))},decommissionReplica:function(){var e=this,t={partitionID:this.ReplicaForm.partitionID,addr:this.ReplicaForm.addr};this.apollo.mutation(this.url.consoleCluster,l.Z.decommissionMetaPartition,t).then((function(t){200===t.code?(e.queryMetaPartitionList(),e.$message({message:e.$t("chubaoFS.message.Success"),type:"success"}),e.closeDialog("decommissionReplica")):e.$message.error(t)}))}},mounted:function(){}},_=y,R=(0,m.Z)(_,$,F,!1,null,"c3c7f968",null),P=R.exports,V=function(){var e=this,t=e._self._c;return t("div",{staticClass:"mp"},[t("div",[t("div",{staticClass:"partition-right"},[t("el-input",{staticStyle:{width:"255px"},attrs:{placeholder:""},model:{value:e.searchVal,callback:function(t){e.searchVal=t},expression:"searchVal"}}),e._v(" "),t("el-button",{staticClass:"ml5",attrs:{type:"primary"},on:{click:e.queryDataPartitionList}},[e._v(e._s(e.$t("chubaoFS.tools.Search")))])],1)]),e._v(" "),t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.resData.loading,expression:"resData.loading"}],staticClass:"data-block"},[t("el-table",{staticClass:"mt10",staticStyle:{width:"100%"},attrs:{data:e.resData.resLists}},[t("el-table-column",{attrs:{prop:"partitionID",label:e.$t("chubaoFS.operations.DataPartitionManagement.PartitionID")}}),e._v(" "),t("el-table-column",{attrs:{prop:"replicaNum",label:e.$t("chubaoFS.operations.DataPartitionManagement.ReplicaNum")}}),e._v(" "),t("el-table-column",{attrs:{prop:"status",label:e.$t("chubaoFS.operations.DataPartitionManagement.Status")}}),e._v(" "),t("el-table-column",{attrs:{prop:"missNodes",label:e.$t("chubaoFS.operations.DataPartitionManagement.MissNodes")}}),e._v(" "),t("el-table-column",{attrs:{prop:"volName",label:e.$t("chubaoFS.operations.DataPartitionManagement.VolName")}}),e._v(" "),t("el-table-column",{attrs:{prop:"loadedTime",label:e.$t("chubaoFS.operations.DataPartitionManagement.LoadedTime")}}),e._v(" "),t("el-table-column",{attrs:{prop:"",label:e.$t("chubaoFS.tools.Actions")},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-dropdown",{attrs:{trigger:"click",size:"medium"}},[t("span",{staticClass:"el-dropdown-link"},[e._v("\n              "+e._s(e.$t("chubaoFS.tools.Replica"))+"\n              "),t("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),e._v(" "),t("el-dropdown-menu",{staticClass:"my-dropdown",attrs:{slot:"dropdown"},slot:"dropdown"},[t("el-dropdown-item",{nativeOn:{click:function(t){return e.openDialog("addReplica",a.row)}}},[e._v(e._s(e.$t("chubaoFS.tools.Add")))]),e._v(" "),t("el-dropdown-item",{nativeOn:{click:function(t){return e.openDialog("deleteReplica",a.row)}}},[e._v(e._s(e.$t("chubaoFS.tools.Delete")))]),e._v(" "),t("el-dropdown-item",{nativeOn:{click:function(t){return e.openDialog("decommissionReplica",a.row)}}},[e._v(e._s(e.$t("chubaoFS.tools.Decommission")))])],1)],1)]}}])})],1),e._v(" "),t("div",{staticClass:"clearfix mt20"},[t("el-pagination",{staticClass:"fr",attrs:{"page-sizes":e.resData.page.pageSizes,"page-size":e.resData.page.pageSize,layout:"sizes, prev, pager, next",total:e.resData.page.totalRecord},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}),e._v(" "),t("span",{staticClass:"fr page-tips pr10"},[e._v(e._s(e.$t("chubaoFS.commonTxt.eachPageShows")))])],1)],1),e._v(" "),t("el-dialog",{attrs:{title:e.$t("chubaoFS.operations.DataPartitionManagement.AddReplica"),visible:e.addReplicaDialog,width:"35%"},on:{"update:visible":function(t){e.addReplicaDialog=t},close:function(t){return e.closeDialog("addReplica")}}},[t("el-form",{attrs:{"label-position":e.labelPosition,model:e.ReplicaForm}},[t("el-form-item",{attrs:{label:e.$t("chubaoFS.operations.DataPartitionManagement.PartitionID")}},[t("el-input",{attrs:{type:"text",disabled:""},model:{value:e.ReplicaForm.partitionID,callback:function(t){e.$set(e.ReplicaForm,"partitionID",t)},expression:"ReplicaForm.partitionID"}})],1),e._v(" "),t("el-form-item",{attrs:{label:e.$t("chubaoFS.operations.DataPartitionManagement.Hosts")}},[t("el-select",{staticStyle:{width:"100%"},model:{value:e.ReplicaForm.addr,callback:function(t){e.$set(e.ReplicaForm,"addr",t)},expression:"ReplicaForm.addr"}},e._l(e.dataNodes,(function(e){return t("el-option",{key:e.addr,attrs:{value:e.addr,label:e.addr+" num:["+e.toDataNode.dataPartitionCount+"] free:["+(e.toDataNode.total-e.toDataNode.used)+"]"}})})),1)],1)],1),e._v(" "),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.closeDialog("addReplica")}}},[e._v(e._s(e.$t("chubaoFS.tools.Cancel")))]),e._v(" "),t("el-button",{attrs:{type:"primary"},on:{click:e.addReplica}},[e._v(e._s(e.$t("chubaoFS.tools.Yes")))])],1)],1),e._v(" "),t("el-dialog",{attrs:{title:e.$t("chubaoFS.operations.DataPartitionManagement.DeleteReplica"),visible:e.deleteReplicaDialog,width:"35%"},on:{"update:visible":function(t){e.deleteReplicaDialog=t},close:function(t){return e.closeDialog("deleteReplica")}}},[t("el-form",{attrs:{"label-position":e.labelPosition,model:e.ReplicaForm}},[t("el-form-item",{attrs:{label:e.$t("chubaoFS.operations.DataPartitionManagement.PartitionID")}},[t("el-input",{attrs:{type:"text",disabled:""},model:{value:e.ReplicaForm.partitionID,callback:function(t){e.$set(e.ReplicaForm,"partitionID",t)},expression:"ReplicaForm.partitionID"}})],1),e._v(" "),t("el-form-item",{attrs:{label:e.$t("chubaoFS.operations.DataPartitionManagement.Hosts")}},[t("el-select",{staticStyle:{width:"100%"},model:{value:e.ReplicaForm.addr,callback:function(t){e.$set(e.ReplicaForm,"addr",t)},expression:"ReplicaForm.addr"}},e._l(e.currentHosts,(function(e){return t("el-option",{key:e,attrs:{value:e,label:e}})})),1)],1)],1),e._v(" "),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.closeDialog("deleteReplica")}}},[e._v(e._s(e.$t("chubaoFS.tools.Cancel")))]),e._v(" "),t("el-button",{attrs:{type:"primary"},on:{click:e.deleteReplica}},[e._v(e._s(e.$t("chubaoFS.tools.Yes")))])],1)],1),e._v(" "),t("el-dialog",{attrs:{title:e.$t("chubaoFS.operations.DataPartitionManagement.DecommissionReplica"),visible:e.decommissionReplicaDialog,width:"35%"},on:{"update:visible":function(t){e.decommissionReplicaDialog=t},close:function(t){return e.closeDialog("decommissionReplica")}}},[t("el-form",{attrs:{"label-position":e.labelPosition,model:e.ReplicaForm}},[t("el-form-item",{attrs:{label:e.$t("chubaoFS.operations.DataPartitionManagement.PartitionID")}},[t("el-input",{attrs:{type:"text",disabled:""},model:{value:e.ReplicaForm.partitionID,callback:function(t){e.$set(e.ReplicaForm,"partitionID",t)},expression:"ReplicaForm.partitionID"}})],1),e._v(" "),t("el-form-item",{attrs:{label:e.$t("chubaoFS.operations.DataPartitionManagement.Hosts")}},[t("el-select",{staticStyle:{width:"100%"},model:{value:e.ReplicaForm.addr,callback:function(t){e.$set(e.ReplicaForm,"addr",t)},expression:"ReplicaForm.addr"}},e._l(e.currentHosts,(function(e){return t("el-option",{key:e,attrs:{value:e,label:e}})})),1)],1)],1),e._v(" "),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.closeDialog("decommissionReplica")}}},[e._v(e._s(e.$t("chubaoFS.tools.Cancel")))]),e._v(" "),t("el-button",{attrs:{type:"primary"},on:{click:e.decommissionReplica}},[e._v(e._s(e.$t("chubaoFS.tools.Yes")))])],1)],1)],1)},N=[],M={name:"dataPartitionManagement",data:function(){return{labelPosition:"top",dataPartitionList:[],resData:{loading:!0,page:{pageSizes:[10,20,30,40],pageNo:1,pageSize:10,totalRecord:0,totalPage:1},resLists:[]},searchVal:"",addReplicaDialog:!1,deleteReplicaDialog:!1,decommissionReplicaDialog:!1,currentHosts:[],dataNodes:[],ReplicaForm:{partitionID:0,addr:""}}},methods:{handleSizeChange:function(e){this.resData.page.pageSize=e,this.resData.page.pageNo=1,this.handleCurrentChange(1)},handleCurrentChange:function(e){this.resData.page.pageNo=e;var t=(e-1)*this.resData.page.pageSize,a=e*this.resData.page.pageSize;this.resData.resLists=this.dataPartitionList.slice(t,a)},queryDataPartitionList:function(){var e=this;this.resData.loading=!0;var t={keyword:"",userID:this.userID,num:1e4};this.apollo.query(this.url.consoleCluster,l.Z.queryDataPartitionList,t).then((function(t){if(e.resData.loading=!1,t.data){var a=[];e.searchVal&&""!==e.searchVal.trim()?t.data.dataPartitionList.forEach((function(t){t.partitionID.toString()!=e.searchVal.trim()&&t.volName!=e.searchVal.trim()||a.push(t)})):a=t.data.dataPartitionList,a.sort((function(e,t){var a=e.peers.length!=e.replicaNum,o=t.peers.length!=t.replicaNum;return a||o?a?o?e.partitionID-t.partitionID:-1:1:0})),e.dataPartitionList=a,e.resData.page.totalRecord=e.dataPartitionList.length,e.handleCurrentChange(1),e.dataPartitionList.forEach((function(e){e.status=(0,r.LR)(e.status),console.log(e.lastLoadedTime),e.loadedTime=(0,v.b4)(1e3*e.lastLoadedTime,"-")+" "+(0,v.li)(1e3*e.lastLoadedTime,":"),console.log(e.loadedTime),e.replicaNum=e.replicaNum+"/"+e.peers.length,void 0==e.missNodes||null==e.missNodes||0==e.missNodes.length?e.missNodes="none":e.missNodes=e.missNodes.toString()}))}else e.$message.error(t)})).catch((function(t){e.resData.loading=!1,console.log(t)}))},queryDataNodeList:function(){var e=this;this.resData.loading=!0;var t={userID:this.userID};this.apollo.query(this.url.consoleCluster,l.Z.queryDataNodeAddrList,t).then((function(t){e.resData.loading=!1;var a={};if(e.currentHosts.forEach((function(e){a[e]=!0})),t.data){var o=[];t.data.clusterView.dataNodes.forEach((function(e){!a[e.addr]&&e.status&&o.push(e)})),o.sort((function(e,t){return t.toDataNode.dataPartitionCount-e.toDataNode.dataPartitionCount})),e.dataNodes=o}else e.$message.error(t)})).catch((function(t){e.resData.loading=!1,console.log(t)}))},openDialog:function(e,t){"addReplica"===e?(this.addReplicaDialog=!0,this.ReplicaForm.partitionID=t.partitionID,this.currentHosts=t.hosts,this.ReplicaForm.addr="",this.queryDataNodeList()):"deleteReplica"==e?(this.deleteReplicaDialog=!0,this.ReplicaForm.partitionID=t.partitionID,this.currentHosts=t.hosts,this.ReplicaForm.addr=""):"decommissionReplica"==e&&(this.decommissionReplicaDialog=!0,this.ReplicaForm.partitionID=t.partitionID,this.currentHosts=t.hosts,this.ReplicaForm.addr="")},closeDialog:function(e){"addReplica"===e?(this.addReplicaDialog=!1,this.ReplicaForm.addr="",this.ReplicaForm.partitionID=0):"deleteReplica"==e?(this.deleteReplicaDialog=!1,this.ReplicaForm.addr="",this.ReplicaForm.partitionID=0):"decommissionReplica"==e&&(this.decommissionReplicaDialog=!1,this.ReplicaForm.addr="",this.ReplicaForm.partitionID=0)},addReplica:function(){var e=this,t={partitionID:this.ReplicaForm.partitionID,addr:this.ReplicaForm.addr};this.apollo.mutation(this.url.consoleCluster,l.Z.addDataReplica,t).then((function(t){200===t.code?(e.queryDataPartitionList(),e.$message({message:e.$t("chubaoFS.message.Success"),type:"success"}),e.closeDialog("addReplica")):e.$message.error(t)}))},deleteReplica:function(){var e=this,t={partitionID:this.ReplicaForm.partitionID,addr:this.ReplicaForm.addr};this.apollo.mutation(this.url.consoleCluster,l.Z.deleteDataReplica,t).then((function(t){200===t.code?(e.queryDataPartitionList(),e.$message({message:e.$t("chubaoFS.message.Success"),type:"success"}),e.closeDialog("deleteReplica")):e.$message.error(t)}))},decommissionReplica:function(){var e=this,t={partitionID:this.ReplicaForm.partitionID,addr:this.ReplicaForm.addr};this.apollo.mutation(this.url.consoleCluster,l.Z.decommissionDataPartition,t).then((function(t){200===t.code?(e.queryDataPartitionList(),e.$message({message:e.$t("chubaoFS.message.Success"),type:"success"}),e.closeDialog("decommissionReplica")):e.$message.error(t)}))}},mounted:function(){}},C=M,w=(0,m.Z)(C,V,N,!1,null,"0349b95c",null),k=w.exports,I={name:"Operations",components:{ServerManagement:p,VolumeManagement:S,MetaPartitionManagement:P,DataPartitionManagement:k},data:function(){return{operationsSelect:"ServerManagement"}},methods:{handleClick:function(e){"ServerManagement"===e.name&&this.$refs.childServer.queryServerList(),"VolumeManagement"===e.name&&this.$refs.childVolume.queryVolumeList(),"MetaPartitionManagement"===e.name&&this.$refs.childMetaPartition.queryMetaPartitionList(),"DataPartitionManagement"===e.name&&this.$refs.childDataPartition.queryDataPartitionList()}}},x=I,L=(0,m.Z)(x,o,i,!1,null,null,null),Z=L.exports},50382:function(e,t,a){var o=a(9015),i=Math.floor,n=function(e,t){var a=e.length,l=i(a/2);return a<8?s(e,t):r(e,n(o(e,0,l),t),n(o(e,l),t),t)},s=function(e,t){var a,o,i=e.length,n=1;while(n<i){o=n,a=e[n];while(o&&t(e[o-1],a)>0)e[o]=e[--o];o!==n++&&(e[o]=a)}return e},r=function(e,t,a,o){var i=t.length,n=a.length,s=0,r=0;while(s<i||r<n)e[s+r]=s<i&&r<n?o(t[s],a[r])<=0?t[s++]:a[r++]:s<i?t[s++]:a[r++];return e};e.exports=n},98494:function(e,t,a){var o=a(23691),i=TypeError;e.exports=function(e,t){if(!delete e[t])throw new i("Cannot delete property "+o(t)+" of "+o(e))}},97365:function(e,t,a){var o=a(30071),i=o.match(/firefox\/(\d+)/i);e.exports=!!i&&+i[1]},37298:function(e,t,a){var o=a(30071);e.exports=/MSIE|Trident/.test(o)},27922:function(e,t,a){var o=a(30071),i=o.match(/AppleWebKit\/(\d+)\./);e.exports=!!i&&+i[1]},27017:function(e,t,a){var o=a(68844),i=a(90690),n=Math.floor,s=o("".charAt),r=o("".replace),l=o("".slice),c=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,u=/\$([$&'`]|\d{1,2})/g;e.exports=function(e,t,a,o,m,d){var p=a+e.length,h=o.length,g=u;return void 0!==m&&(m=i(m),g=c),r(d,g,(function(i,r){var c;switch(s(r,0)){case"$":return"$";case"&":return e;case"`":return l(t,0,a);case"'":return l(t,p);case"<":c=m[l(r,1,-1)];break;default:var u=+r;if(0===u)return i;if(u>h){var d=n(u/10);return 0===d?i:d<=h?void 0===o[d-1]?s(r,1):o[d-1]+s(r,1):i}c=o[u-1]}return void 0===c?"":c}))}},91245:function(e,t,a){var o=a(48999),i=a(6648),n=a(44201),s=n("match");e.exports=function(e){var t;return o(e)&&(void 0!==(t=e[s])?!!t:"RegExp"===i(e))}},63477:function(e,t,a){var o=a(22615),i=a(36812),n=a(23622),s=a(69633),r=RegExp.prototype;e.exports=function(e){var t=e.flags;return void 0!==t||"flags"in r||i(e,"flags")||!n(r,e)?t:o(s,e)}},90534:function(e,t,a){var o=a(68700),i=a(34327),n=a(74684),s=RangeError;e.exports=function(e){var t=i(n(this)),a="",r=o(e);if(r<0||r===1/0)throw new s("Wrong number of repetitions");for(;r>0;(r>>>=1)&&(t+=t))1&r&&(a+=t);return a}},75984:function(e,t,a){var o=a(41236).PROPER,i=a(3689),n=a(86350),s="âÂá ";e.exports=function(e){return i((function(){return!!n[e]()||s[e]()!==s||o&&n[e].name!==e}))}},6203:function(e,t,a){var o=a(79989),i=a(68844),n=a(94413),s=a(65290),r=a(16834),l=i([].join),c=n!==Object,u=c||!r("join",",");o({target:"Array",proto:!0,forced:u},{join:function(e){return l(s(this),void 0===e?",":e)}})},65137:function(e,t,a){var o=a(79989),i=a(68844),n=a(10509),s=a(90690),r=a(6310),l=a(98494),c=a(34327),u=a(3689),m=a(50382),d=a(16834),p=a(97365),h=a(37298),g=a(3615),v=a(27922),f=[],b=i(f.sort),D=i(f.push),S=u((function(){f.sort(void 0)})),$=u((function(){f.sort(null)})),F=d("sort"),y=!u((function(){if(g)return g<70;if(!(p&&p>3)){if(h)return!0;if(v)return v<603;var e,t,a,o,i="";for(e=65;e<76;e++){switch(t=String.fromCharCode(e),e){case 66:case 69:case 70:case 72:a=3;break;case 68:case 71:a=4;break;default:a=2}for(o=0;o<47;o++)f.push({k:t+o,v:a})}for(f.sort((function(e,t){return t.v-e.v})),o=0;o<f.length;o++)t=f[o].k.charAt(0),i.charAt(i.length-1)!==t&&(i+=t);return"DGBEFHACIJK"!==i}})),_=S||!$||!F||!y,R=function(e){return function(t,a){return void 0===a?-1:void 0===t?1:void 0!==e?+e(t,a)||0:c(t)>c(a)?1:-1}};o({target:"Array",proto:!0,forced:_},{sort:function(e){void 0!==e&&n(e);var t=s(this);if(y)return void 0===e?b(t):b(t,e);var a,o,i=[],c=r(t);for(o=0;o<c;o++)o in t&&D(i,t[o]);m(i,R(e)),a=r(i),o=0;while(o<a)t[o]=i[o++];while(o<c)l(t,o++);return t}})},97389:function(e,t,a){var o=a(79989),i=a(68844),n=a(68700),s=a(23648),r=a(90534),l=a(3689),c=RangeError,u=String,m=Math.floor,d=i(r),p=i("".slice),h=i(1..toFixed),g=function(e,t,a){return 0===t?a:t%2===1?g(e,t-1,a*e):g(e*e,t/2,a)},v=function(e){var t=0,a=e;while(a>=4096)t+=12,a/=4096;while(a>=2)t+=1,a/=2;return t},f=function(e,t,a){var o=-1,i=a;while(++o<6)i+=t*e[o],e[o]=i%1e7,i=m(i/1e7)},b=function(e,t){var a=6,o=0;while(--a>=0)o+=e[a],e[a]=m(o/t),o=o%t*1e7},D=function(e){var t=6,a="";while(--t>=0)if(""!==a||0===t||0!==e[t]){var o=u(e[t]);a=""===a?o:a+d("0",7-o.length)+o}return a},S=l((function(){return"0.000"!==h(8e-5,3)||"1"!==h(.9,0)||"1.25"!==h(1.255,2)||"1000000000000000128"!==h(0xde0b6b3a7640080,0)}))||!l((function(){h({})}));o({target:"Number",proto:!0,forced:S},{toFixed:function(e){var t,a,o,i,r=s(this),l=n(e),m=[0,0,0,0,0,0],h="",S="0";if(l<0||l>20)throw new c("Incorrect fraction digits");if(r!==r)return"NaN";if(r<=-1e21||r>=1e21)return u(r);if(r<0&&(h="-",r=-r),r>1e-21)if(t=v(r*g(2,69,1))-69,a=t<0?r*g(2,-t,1):r/g(2,t,1),a*=4503599627370496,t=52-t,t>0){f(m,0,a),o=l;while(o>=7)f(m,1e7,0),o-=7;f(m,g(10,o,1),0),o=t-1;while(o>=23)b(m,1<<23),o-=23;b(m,1<<o),f(m,1,1),b(m,2),S=D(m)}else f(m,0,a),f(m,1<<-t,0),S=D(m)+d("0",l);return l>0?(i=S.length,S=h+(i<=l?"0."+d("0",l-i)+S:p(S,0,i-l)+"."+p(S,i-l))):S=h+S,S}})},52003:function(e,t,a){var o=a(67697),i=a(19037),n=a(68844),s=a(35266),r=a(33457),l=a(75773),c=a(72741).f,u=a(23622),m=a(91245),d=a(34327),p=a(63477),h=a(87901),g=a(38055),v=a(11880),f=a(3689),b=a(36812),D=a(618).enforce,S=a(14241),$=a(44201),F=a(62100),y=a(26738),_=$("match"),R=i.RegExp,P=R.prototype,V=i.SyntaxError,N=n(P.exec),M=n("".charAt),C=n("".replace),w=n("".indexOf),k=n("".slice),I=/^\?<[^\s\d!#%&*+<=>@^][^\s!#%&*+<=>@^]*>/,x=/a/g,L=/a/g,Z=new R(x)!==x,z=h.MISSED_STICKY,T=h.UNSUPPORTED_Y,q=o&&(!Z||z||F||y||f((function(){return L[_]=!1,R(x)!==x||R(L)===L||"/a/i"!==String(R(x,"i"))}))),E=function(e){for(var t,a=e.length,o=0,i="",n=!1;o<=a;o++)t=M(e,o),"\\"!==t?n||"."!==t?("["===t?n=!0:"]"===t&&(n=!1),i+=t):i+="[\\s\\S]":i+=t+M(e,++o);return i},A=function(e){for(var t,a=e.length,o=0,i="",n=[],s={},r=!1,l=!1,c=0,u="";o<=a;o++){if(t=M(e,o),"\\"===t)t+=M(e,++o);else if("]"===t)r=!1;else if(!r)switch(!0){case"["===t:r=!0;break;case"("===t:N(I,k(e,o+1))&&(o+=2,l=!0),i+=t,c++;continue;case">"===t&&l:if(""===u||b(s,u))throw new V("Invalid capture group name");s[u]=!0,n[n.length]=[u,c],l=!1,u="";continue}l?u+=t:i+=t}return[i,n]};if(s("RegExp",q)){for(var O=function(e,t){var a,o,i,n,s,c,h=u(P,this),g=m(e),v=void 0===t,f=[],b=e;if(!h&&g&&v&&e.constructor===O)return e;if((g||u(P,e))&&(e=e.source,v&&(t=p(b))),e=void 0===e?"":d(e),t=void 0===t?"":d(t),b=e,F&&"dotAll"in x&&(o=!!t&&w(t,"s")>-1,o&&(t=C(t,/s/g,""))),a=t,z&&"sticky"in x&&(i=!!t&&w(t,"y")>-1,i&&T&&(t=C(t,/y/g,""))),y&&(n=A(e),e=n[0],f=n[1]),s=r(R(e,t),h?this:P,O),(o||i||f.length)&&(c=D(s),o&&(c.dotAll=!0,c.raw=O(E(e),a)),i&&(c.sticky=!0),f.length&&(c.groups=f)),e!==b)try{l(s,"source",""===b?"(?:)":b)}catch(S){}return s},B=c(R),U=0;B.length>U;)g(O,R,B[U++]);P.constructor=O,O.prototype=P,v(i,"RegExp",O,{constructor:!0})}S("RegExp")},68518:function(e,t,a){var o=a(67697),i=a(62100),n=a(6648),s=a(62148),r=a(618).get,l=RegExp.prototype,c=TypeError;o&&i&&s(l,"dotAll",{configurable:!0,get:function(){if(this!==l){if("RegExp"===n(this))return!!r(this).dotAll;throw new c("Incompatible receiver, RegExp required")}}})},13440:function(e,t,a){var o=a(67697),i=a(87901).MISSED_STICKY,n=a(6648),s=a(62148),r=a(618).get,l=RegExp.prototype,c=TypeError;o&&i&&s(l,"sticky",{configurable:!0,get:function(){if(this!==l){if("RegExp"===n(this))return!!r(this).sticky;throw new c("Incompatible receiver, RegExp required")}}})},7409:function(e,t,a){a(64043);var o=a(79989),i=a(22615),n=a(69985),s=a(85027),r=a(34327),l=function(){var e=!1,t=/[ac]/;return t.exec=function(){return e=!0,/./.exec.apply(this,arguments)},!0===t.test("abc")&&e}(),c=/./.test;o({target:"RegExp",proto:!0,forced:!l},{test:function(e){var t=s(this),a=r(e),o=t.exec;if(!n(o))return i(c,t,a);var l=i(o,t,a);return null!==l&&(s(l),!0)}})},12826:function(e,t,a){var o=a(41236).PROPER,i=a(11880),n=a(85027),s=a(34327),r=a(3689),l=a(63477),c="toString",u=RegExp.prototype,m=u[c],d=r((function(){return"/a/b"!==m.call({source:"a",flags:"b"})})),p=o&&m.name!==c;(d||p)&&i(RegExp.prototype,c,(function(){var e=n(this),t=s(e.source),a=s(l(e));return"/"+t+"/"+a}),{unsafe:!0})},57267:function(e,t,a){var o=a(61735),i=a(22615),n=a(68844),s=a(65773),r=a(3689),l=a(85027),c=a(69985),u=a(981),m=a(68700),d=a(43126),p=a(34327),h=a(74684),g=a(71514),v=a(54849),f=a(27017),b=a(66100),D=a(44201),S=D("replace"),$=Math.max,F=Math.min,y=n([].concat),_=n([].push),R=n("".indexOf),P=n("".slice),V=function(e){return void 0===e?e:String(e)},N=function(){return"$0"==="a".replace(/./,"$0")}(),M=function(){return!!/./[S]&&""===/./[S]("a","$0")}(),C=!r((function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")}));s("replace",(function(e,t,a){var n=M?"$":"$0";return[function(e,a){var o=h(this),n=u(e)?void 0:v(e,S);return n?i(n,e,o,a):i(t,p(o),e,a)},function(e,i){var s=l(this),r=p(e);if("string"==typeof i&&-1===R(i,n)&&-1===R(i,"$<")){var u=a(t,s,r,i);if(u.done)return u.value}var h=c(i);h||(i=p(i));var v,D=s.global;D&&(v=s.unicode,s.lastIndex=0);var S,N=[];while(1){if(S=b(s,r),null===S)break;if(_(N,S),!D)break;var M=p(S[0]);""===M&&(s.lastIndex=g(r,d(s.lastIndex),v))}for(var C="",w=0,k=0;k<N.length;k++){S=N[k];for(var I,x=p(S[0]),L=$(F(m(S.index),r.length),0),Z=[],z=1;z<S.length;z++)_(Z,V(S[z]));var T=S.groups;if(h){var q=y([x],Z,L,r);void 0!==T&&_(q,T),I=p(o(i,void 0,q))}else I=f(x,r,L,Z,T,i);L>=w&&(C+=P(r,w,L)+I,w=L+x.length)}return C+P(r,w)}]}),!C||!N||M)},28436:function(e,t,a){var o=a(79989),i=a(61435).trim,n=a(75984);o({target:"String",proto:!0,forced:n("trim")},{trim:function(){return i(this)}})}}]);