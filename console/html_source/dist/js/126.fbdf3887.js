"use strict";(self["webpackJsonp_cfs-console"]=self["webpackJsonp_cfs-console"]||[]).push([[126],{77823:function(e,t,o){var a,s,n,r,i,l,u,c,m,p,d,g,h,v,$,b,f,y,F=o(2106),S=o(4969),_={getUserInfo:(0,S.ZP)(a||(a=(0,F.Z)(["\n    query getUserInfo($userID: String) {\n      getUserInfo(userID: $userID) {\n        access_key\n        secret_key\n      }\n    }\n  "]))),getKeys:(0,S.ZP)(s||(s=(0,F.Z)(["\n    query getKeys($cluster: String, $userID: String, $name: String) {\n      getKeys(cluster: $cluster, userID: $userID, name: $name) {\n        access_key\n        secret_key\n      }\n    }\n  "]))),volDataPartitions:(0,S.ZP)(n||(n=(0,F.Z)(["\n    query volDataPartitions(\n      $cluster: String\n      $volume: String\n      $page: int\n      $pageSize: int\n    ) {\n      volDataPartitions(\n        cluster: $cluster\n        volume: $volume\n        page: $page\n        pageSize: $pageSize\n      ) {\n        data {\n          partitionID\n          replicaNum\n          status\n          leader\n          ecMigrateStatus\n          isRecover\n          hosts {\n            addr\n          }\n        }\n        total\n      }\n    }\n  "]))),volMetaPartitions:(0,S.ZP)(r||(r=(0,F.Z)(["\n    query volMetaPartitions(\n      $cluster: String\n      $volume: String\n      $page: int\n      $pageSize: int\n    ) {\n      volMetaPartitions(\n        cluster: $cluster\n        volume: $volume\n        page: $page\n        pageSize: $pageSize\n      ) {\n        data {\n          partitionID\n          replicaNum\n          status\n          leader\n          start\n          end\n          dentryCount\n          inodeCount\n          maxExistIno\n          hosts {\n            addr\n          }\n        }\n        total\n      }\n    }\n  "]))),queryVolumeList:(0,S.ZP)(i||(i=(0,F.Z)(["\n    query listVolume(\n      $cluster: String\n      $name: String\n      $page: int\n      $pageSize: int\n    ) {\n      listVolume(\n        cluster: $cluster\n        name: $name\n        page: $page\n        pageSize: $pageSize\n      ) {\n        data {\n          name\n          owner\n          totalSize\n          usedSize\n          usedRatio\n          fileCount\n          replicaNum\n          createTime\n          mpCount\n          dpCount\n        }\n        total\n      }\n    }\n  "]))),zoneList:(0,S.ZP)(l||(l=(0,F.Z)(["\n    query zoneList($cluster: String) {\n      zoneList(cluster: $cluster)\n    }\n  "]))),createVolume:(0,S.ZP)(u||(u=(0,F.Z)(["\n    mutation createVolume(\n      $cluster: String\n      $capacity: int32\n      $name: String\n      $owner: String\n      $zone: String\n      $description: String\n    ) {\n      createVolume(\n        cluster: $cluster\n        capacity: $capacity\n        name: $name\n        owner: $owner\n        zone: $zone\n        description: $description\n      ) {\n        code\n        message\n      }\n    }\n  "]))),getVolume:(0,S.ZP)(c||(c=(0,F.Z)(["\n    query getVolume($cluster: String, $name: String) {\n      getVolume(cluster: $cluster, name: $name) {\n        name\n        owner\n        dpSelectorName\n        dpReplicaNum\n        defaultStoreMode\n        trashRemainingDays\n        capacity\n        enableToken\n        forceROW\n        enableWriteCache\n        followerRead\n        remoteCacheBoostEnable\n      }\n    }\n  "]))),updateVolume:(0,S.ZP)(m||(m=(0,F.Z)(["\n    mutation updateVolume(\n      $cluster: String\n      $authKey: String\n      $name: String\n      $dpSelectorName: String\n      $defaultStoreMode: Uint64\n      $trashRemainingDays: Uint64\n      $capacity: Uint64\n      $enableToken: Bool\n      $forceROW: Bool\n      $enableWriteCache: Bool\n      $followerRead: Bool\n      $remoteCacheBoostEnable: Bool\n    ) {\n      updateVolume(\n        cluster: $cluster\n        authKey: $authKey\n        name: $name\n        dpSelectorName: $dpSelectorName\n        dpReplicaNum: $dpReplicaNum\n        defaultStoreMode: $defaultStoreMode\n        trashRemainingDays: $trashRemainingDays\n        capacity: $capacity\n        enableToken: $enableToken\n        forceROW: $forceROW\n        enableWriteCache: $enableWriteCache\n        followerRead: $followerRead\n        remoteCacheBoostEnable: $remoteCacheBoostEnable\n      ) {\n        name\n      }\n    }\n  "]))),deleteVolume:(0,S.ZP)(p||(p=(0,F.Z)(["\n    mutation deleteVolume($cluster: String, $authKey: String, $name: String) {\n      deleteVolume(cluster: $cluster, authKey: $authKey, name: $name) {\n        code\n        message\n      }\n    }\n  "]))),queryPermissionList:(0,S.ZP)(d||(d=(0,F.Z)(["\n    query volPermission(\n      $cluster: String\n      $userID: String\n      $name: String\n      $permission: String\n    ) {\n      volPermission(\n        cluster: $cluster\n        userID: $userID\n        name: $name\n        permission: $permission\n      ) {\n        userID\n        access\n      }\n    }\n  "]))),grantPermission:(0,S.ZP)(g||(g=(0,F.Z)(["\n    mutation updateUserPolicy(\n      $cluster: String\n      $policy: Array\n      $userID: String\n      $volume: String\n    ) {\n      updateUserPolicy(\n        cluster: $cluster\n        policy: $policy\n        userID: $userID\n        volume: $volume\n      ) {\n        user_id\n      }\n    }\n  "]))),deletePermission:(0,S.ZP)(h||(h=(0,F.Z)(["\n    mutation removeUserPolicy(\n      $cluster: String\n      $userID: String\n      $volume: String\n    ) {\n      removeUserPolicy(cluster: $cluster, userID: $userID, volume: $volume) {\n        user_id\n      }\n    }\n  "]))),queryFileList:(0,S.ZP)(v||(v=(0,F.Z)(["\n    query listFile($request: Object, $volName: String) {\n      listFile(request: $request, volName: $volName) {\n        infos {\n          FSFileInfo {\n            key\n            value\n          }\n          eTag\n          inode\n          mIMEType\n          mode\n          modifyTime\n          createTime\n          path\n          size\n        }\n        isTruncated\n        nextMarker\n        prefixes\n      }\n    }\n  "]))),createFolder:(0,S.ZP)($||($=(0,F.Z)(["\n    mutation createDir($path: String, $volName: String) {\n      createDir(path: $path, volName: $volName) {\n        eTag\n      }\n    }\n  "]))),signURL:(0,S.ZP)(b||(b=(0,F.Z)(["\n    mutation signURL($path: String, $volName: String, $expireMinutes: Uint64) {\n      signURL(path: $path, volName: $volName, expireMinutes: $expireMinutes) {\n        code\n        message\n      }\n    }\n  "]))),deleteDir:(0,S.ZP)(f||(f=(0,F.Z)(["\n    mutation deleteDir($path: String, $volName: String) {\n      deleteDir(path: $path, volName: $volName) {\n        code\n        message\n      }\n    }\n  "]))),deleteFile:(0,S.ZP)(y||(y=(0,F.Z)(["\n    mutation deleteFile($path: String, $volName: String) {\n      deleteFile(path: $path, volName: $volName) {\n        code\n        message\n      }\n    }\n  "])))};t.Z=_},69092:function(e,t,o){o.d(t,{Ur:function(){return r},b4:function(){return s},li:function(){return n}});o(60228),o(12826);function a(e){var t=null!==e?new Date(e):new Date;return{year:t.getFullYear(),month:t.getMonth(),date:t.getDate(),hour:t.getHours(),minute:t.getMinutes(),second:t.getSeconds(),milli:t.getMilliseconds()}}function s(e,t){t=t||"-";var o="[object Object]"===Object.prototype.toString.call(e)?e:a(e),s=o.month+1<10?"0"+(o.month+1):o.month+1,n=o.date<10?"0"+o.date:o.date;return o.year+t+s+t+n}function n(e,t){t=t||":";var o="[object Object]"===Object.prototype.toString.call(e)?e:a(e),s=o.hour<10?"0"+o.hour:o.hour,n=o.minute<10?"0"+o.minute:o.minute,r=o.second<10?"0"+o.second:o.second;return s+t+n+t+r}function r(e){var t=a(e),o=s(t)+" "+n(t);return o}},64126:function(e,t,o){o.r(t),o.d(t,{default:function(){return m}});o(34284),o(59749),o(86544);var a=function(){var e=this,t=e._self._c;return t("div",{},[t("el-card",{staticClass:"box-card"},[t("cluster",{on:{refresh:e.initPage}})],1),e._v(" "),t("div",{staticClass:"pt20"}),e._v(" "),t("div",{staticClass:"volume-content"},[t("div",[t("div",{staticClass:"volume-left"},[t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.openDialog("createVolume")}}},[t("i",{staticClass:"btn-icon paper-icon"}),e._v("\n          "+e._s(e.$t("chubaoFS.volume.CreateVolume"))+"\n        ")])],1),e._v(" "),t("div",{staticClass:"volume-right"},[t("span",[e._v(e._s(e.$t("chubaoFS.volume.VolumeName")))]),e._v(" "),t("el-input",{staticStyle:{width:"255px"},attrs:{placeholder:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.queryVolumeList("reset")}},model:{value:e.searchVal,callback:function(t){e.searchVal=t},expression:"searchVal"}}),e._v(" "),t("el-button",{staticClass:"ml5",attrs:{type:"primary"},on:{click:function(t){return e.queryVolumeList("reset")}}},[e._v(e._s(e.$t("chubaoFS.tools.Search"))+"\n        ")])],1)]),e._v(" "),t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.resData.loading,expression:"resData.loading"}],staticClass:"data-block"},[t("el-table",{staticClass:"mt10",staticStyle:{width:"100%"},attrs:{data:e.resData.resLists}},[t("el-table-column",{attrs:{prop:"name",label:e.$t("chubaoFS.volume.VolumeName")}}),e._v(" "),t("el-table-column",{attrs:{prop:"totalSize",label:e.$t("chubaoFS.volume.Totalcapacity")}}),e._v(" "),t("el-table-column",{attrs:{prop:"usedSize",label:e.$t("chubaoFS.volume.Used")}}),e._v(" "),t("el-table-column",{attrs:{prop:"usedRatio",label:e.$t("chubaoFS.volume.UsedRate")}}),e._v(" "),t("el-table-column",{attrs:{prop:"fileCount",label:e.$t("chubaoFS.volume.InodeCount")}}),e._v(" "),t("el-table-column",{attrs:{prop:"replicaNum",label:e.$t("chubaoFS.volume.Replications")}}),e._v(" "),t("el-table-column",{attrs:{prop:"dpCount",label:"dp数"},scopedSlots:e._u([{key:"default",fn:function(o){return t("span",{staticClass:"click-style"},[t("router-link",{attrs:{to:{path:"/volume/dpList",query:{clusterName:e.$route.query.clusterName,volume:o.row.name}}}},[e._v(e._s(o.row.dpCount))])],1)}}])}),e._v(" "),t("el-table-column",{attrs:{prop:"mpCount",label:"mp数"},scopedSlots:e._u([{key:"default",fn:function(o){return t("span",{staticClass:"click-style"},[t("router-link",{attrs:{to:{path:"/volume/mpList",query:{clusterName:e.$route.query.clusterName,volume:o.row.name}}}},[e._v(e._s(o.row.mpCount))])],1)}}])}),e._v(" "),t("el-table-column",{attrs:{prop:"owner",label:e.$t("chubaoFS.volume.OwnerID")}}),e._v(" "),t("el-table-column",{attrs:{prop:"createTime",label:e.$t("chubaoFS.volume.CreateTime")}}),e._v(" "),t("el-table-column",{attrs:{prop:"",label:e.$t("chubaoFS.tools.Actions")},scopedSlots:e._u([{key:"default",fn:function(o){return[t("el-dropdown",{attrs:{trigger:"click"}},[t("span",{staticClass:"el-dropdown-link"},[e._v("\n                "+e._s(e.$t("chubaoFS.tools.Actions"))+"\n                "),t("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),e._v(" "),t("el-dropdown-menu",{staticClass:"my-dropdown",attrs:{slot:"dropdown"},slot:"dropdown"},[t("el-dropdown-item",{nativeOn:{click:function(t){return e.openDialog("extend",o.row)}}},[e._v(e._s(e.$t("chubaoFS.tools.Extend"))+"\n                ")]),e._v(" "),t("el-dropdown-item",{nativeOn:{click:function(t){return e.openDialog("permission",o.row)}}},[e._v(e._s(e.$t("chubaoFS.tools.Permission"))+"\n                ")]),e._v(" "),t("el-dropdown-item",{nativeOn:{click:function(t){return e.openDialog("edit",o.row)}}},[e._v(e._s(e.$t("chubaoFS.tools.Edit"))+"\n                ")]),e._v(" "),t("el-dropdown-item",{nativeOn:{click:function(t){return e.openDialog("accessKeys",o.row)}}},[e._v(e._s(e.$t("chubaoFS.volume.AccessKeys"))+"\n                ")]),e._v(" "),t("el-dropdown-item",{nativeOn:{click:function(t){return e.goDepot(o.row)}}},[e._v(e._s(e.$t("chubaoFS.tools.Depot"))+"\n                ")])],1)],1)]}}])})],1),e._v(" "),t("div",{staticClass:"clearfix mt20"},[t("el-pagination",{staticClass:"fr",attrs:{"page-sizes":e.page.pageSizes,"page-size":e.page.pageSize,"current-page":e.page.pageNo,layout:"sizes, prev, pager, next",total:e.page.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}),e._v(" "),t("span",{staticClass:"fr page-tips pr10"},[e._v("共 "+e._s(e.page.total)+"条")])],1)],1)]),e._v(" "),t("el-dialog",{attrs:{title:e.$t("chubaoFS.volume.AccessKeys"),visible:e.accessKeysDialog,width:"35%"},on:{"update:visible":function(t){e.accessKeysDialog=t}}},[t("div",{staticClass:"pl10"},[e._v("\n      "+e._s(e.$t("chubaoFS.volume.AccessKeys"))+"："+e._s(e.accessKey)+"\n    ")]),e._v(" "),t("div",{staticClass:"mt20 pl10"},[e._v("\n      "+e._s(e.$t("chubaoFS.volume.SecretKey"))+"："+e._s(e.secretKey)+"\n    ")]),e._v(" "),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary"},on:{click:function(t){e.accessKeysDialog=!1}}},[e._v(e._s(e.$t("chubaoFS.tools.OK")))])],1)]),e._v(" "),t("el-dialog",{attrs:{title:e.$t("chubaoFS.volume.CreateVolume"),visible:e.createVolumeDialog,width:"35%"},on:{"update:visible":function(t){e.createVolumeDialog=t},close:function(t){return e.closeDialog("create")}}},[t("el-form",{ref:"createVolumeForm",attrs:{"label-position":e.labelPosition,model:e.createVolumeForm,rules:e.rules}},[t("el-form-item",{attrs:{label:e.$t("chubaoFS.volume.VolumeName"),prop:"name",rules:[{required:!0,message:e.$t("chubaoFS.volume.EnterNameTip"),trigger:"blur"},{validator:e.checkVolName,message:e.$t("chubaoFS.volume.NameRulesTip"),trigger:"blur"}]}},[t("el-input",{model:{value:e.createVolumeForm.name,callback:function(t){e.$set(e.createVolumeForm,"name",t)},expression:"createVolumeForm.name"}})],1),e._v(" "),t("el-form-item",{attrs:{label:e.$t("chubaoFS.volume.Totalcapacity")+"（GB）",prop:"totalCapacity",rules:[{required:!0,message:e.$t("chubaoFS.volume.EnterCapacityTip"),trigger:"blur"},{validator:e.checkNumber,message:e.$t("chubaoFS.volume.CapacityRules"),trigger:"blur"}]}},[t("el-input",{model:{value:e.createVolumeForm.totalCapacity,callback:function(t){e.$set(e.createVolumeForm,"totalCapacity",t)},expression:"createVolumeForm.totalCapacity"}})],1),e._v(" "),t("el-form-item",{attrs:{label:e.$t("chubaoFS.volume.OwnerID"),prop:"owner",rules:[{required:!0,message:"请输入所有者ID",trigger:"blur"},{validator:e.checkOwnerId,message:"请输入正确的所有者ID（字母开头，可以包含数字， 1-21个字符）",trigger:"blur"}]}},[t("el-input",{model:{value:e.createVolumeForm.owner,callback:function(t){e.$set(e.createVolumeForm,"owner",t)},expression:"createVolumeForm.owner"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"zone",prop:"zone",rules:[{required:!0,message:"请选择zone",trigger:"change"}]}},[t("el-select",{attrs:{multiple:""},model:{value:e.createVolumeForm.zone,callback:function(t){e.$set(e.createVolumeForm,"zone",t)},expression:"createVolumeForm.zone"}},e._l(e.zoneList,(function(e){return t("el-option",{key:e,attrs:{value:e,label:e}})})),1)],1),e._v(" "),t("el-form-item",{attrs:{label:"申请原因",prop:"notes"}},[t("el-input",{attrs:{type:"textarea"},model:{value:e.createVolumeForm.notes,callback:function(t){e.$set(e.createVolumeForm,"notes",t)},expression:"createVolumeForm.notes"}})],1)],1),e._v(" "),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.closeDialog("create")}}},[e._v(e._s(e.$t("chubaoFS.tools.Cancel")))]),e._v(" "),t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.createVolume("createVolumeForm")}}},[e._v(e._s(e.$t("chubaoFS.tools.Create")))])],1)],1),e._v(" "),t("el-dialog",{attrs:{title:e.$t("chubaoFS.volume.VolumeInfo"),visible:e.volumeInfoDialog,width:"35%"},on:{"update:visible":function(t){e.volumeInfoDialog=t}}},[t("div",{staticClass:"vol-info"},[e._v(e._s(e.$t("chubaoFS.volume.VolumeInfoTip")))]),e._v(" "),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary"},on:{click:function(t){e.volumeInfoDialog=!1}}},[e._v(e._s(e.$t("chubaoFS.tools.OK")))])],1)]),e._v(" "),t("el-dialog",{attrs:{title:e.$t("chubaoFS.volume.EditVolume"),visible:e.editVolumeDialog,width:"35%"},on:{"update:visible":function(t){e.editVolumeDialog=t}}},[t("el-form",{attrs:{model:e.editVolumeForm,"label-position":e.labelPosition}},[t("el-form-item",{attrs:{label:"DpSelector"}},[t("el-radio-group",{model:{value:e.editVolumeForm.dpSelectorName,callback:function(t){e.$set(e.editVolumeForm,"dpSelectorName",t)},expression:"editVolumeForm.dpSelectorName"}},[t("el-radio",{attrs:{label:"default"}}),e._v(" "),t("el-radio",{attrs:{label:"kfaster"}})],1)],1),e._v(" "),t("el-form-item",{attrs:{label:e.$t("chubaoFS.volume.copies")}},[t("el-radio-group",{model:{value:e.editVolumeForm.dpReplicaNum,callback:function(t){e.$set(e.editVolumeForm,"dpReplicaNum",t)},expression:"editVolumeForm.dpReplicaNum"}},[t("el-radio",{attrs:{label:2}}),e._v(" "),t("el-radio",{attrs:{label:3}}),e._v(" "),t("el-radio",{attrs:{label:5}})],1)],1),e._v(" "),t("el-form-item",{attrs:{label:e.$t("chubaoFS.volume.metadata")}},[t("el-radio-group",{model:{value:e.editVolumeForm.defaultStoreMode,callback:function(t){e.$set(e.editVolumeForm,"defaultStoreMode",t)},expression:"editVolumeForm.defaultStoreMode"}},[t("el-radio",{attrs:{label:1}},[e._v("内存")]),e._v(" "),t("el-radio",{attrs:{label:2}},[e._v("rocksDB")])],1)],1),e._v(" "),t("el-form-item",{attrs:{label:e.$t("chubaoFS.volume.depotDay")}},[t("el-input",{model:{value:e.editVolumeForm.trashRemainingDays,callback:function(t){e.$set(e.editVolumeForm,"trashRemainingDays",e._n(t))},expression:"editVolumeForm.trashRemainingDays"}})],1),e._v(" "),t("el-form-item",{attrs:{label:e.$t("chubaoFS.volume.capacity")}},[t("el-input",{model:{value:e.editVolumeForm.capacity,callback:function(t){e.$set(e.editVolumeForm,"capacity",e._n(t))},expression:"editVolumeForm.capacity"}})],1),e._v(" "),t("el-form-item",{attrs:{label:e.$t("chubaoFS.volume.token")}},[t("el-switch",{model:{value:e.editVolumeForm.enableToken,callback:function(t){e.$set(e.editVolumeForm,"enableToken",t)},expression:"editVolumeForm.enableToken"}})],1),e._v(" "),t("el-form-item",{attrs:{label:e.$t("chubaoFS.volume.forcedrow")}},[t("el-switch",{model:{value:e.editVolumeForm.forceROW,callback:function(t){e.$set(e.editVolumeForm,"forceROW",t)},expression:"editVolumeForm.forceROW"}})],1),e._v(" "),t("el-form-item",{attrs:{label:e.$t("chubaoFS.volume.sdk")}},[t("el-switch",{model:{value:e.editVolumeForm.enableWriteCache,callback:function(t){e.$set(e.editVolumeForm,"enableWriteCache",t)},expression:"editVolumeForm.enableWriteCache"}})],1),e._v(" "),t("el-form-item",{attrs:{label:e.$t("chubaoFS.volume.follow")}},[t("el-switch",{model:{value:e.editVolumeForm.followerRead,callback:function(t){e.$set(e.editVolumeForm,"followerRead",t)},expression:"editVolumeForm.followerRead"}})],1),e._v(" "),t("el-form-item",{attrs:{label:e.$t("chubaoFS.volume.cache")}},[t("el-switch",{model:{value:e.editVolumeForm.remoteCacheBoostEnable,callback:function(t){e.$set(e.editVolumeForm,"remoteCacheBoostEnable",t)},expression:"editVolumeForm.remoteCacheBoostEnable"}})],1)],1),e._v(" "),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.editVolumeDialog=!1}}},[e._v(e._s(e.$t("chubaoFS.tools.Cancel")))]),e._v(" "),t("el-button",{attrs:{type:"primary"},on:{click:e.updateVolume}},[e._v(e._s(e.$t("chubaoFS.tools.Update")))])],1)],1),e._v(" "),t("el-dialog",{attrs:{title:e.$t("chubaoFS.volume.Comments"),visible:e.notesDialog,width:"35%"},on:{"update:visible":function(t){e.notesDialog=t}}},[t("div",{staticClass:"pl10"},[e._v(e._s(e.description))]),e._v(" "),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary"},on:{click:function(t){e.notesDialog=!1}}},[e._v(e._s(e.$t("chubaoFS.tools.OK")))])],1)]),e._v(" "),t("el-dialog",{attrs:{title:e.$t("chubaoFS.volume.IncreaseVolumeCapacity"),visible:e.volumeExtensionDialog,width:"35%"},on:{"update:visible":function(t){e.volumeExtensionDialog=t},close:function(t){return e.closeDialog("extend")}}},[t("el-form",{attrs:{"label-position":e.labelPosition,model:e.editVolumeForm}},[t("el-form-item",{attrs:{label:e.$t("chubaoFS.volume.VolumeName")}},[t("el-input",{attrs:{type:"text",disabled:""},model:{value:e.editVolumeForm.name,callback:function(t){e.$set(e.editVolumeForm,"name",t)},expression:"editVolumeForm.name"}})],1),e._v(" "),t("el-form-item",{attrs:{label:e.$t("chubaoFS.volume.Totalcapacity")}},[t("el-input",{attrs:{type:"text",disabled:""},model:{value:e.editVolumeForm.totalSize,callback:function(t){e.$set(e.editVolumeForm,"totalSize",t)},expression:"editVolumeForm.totalSize"}})],1),e._v(" "),t("el-form-item",{attrs:{label:e.$t("chubaoFS.volume.Extendto")+"（GB）"}},[t("el-input",{attrs:{type:"text"},model:{value:e.capacity,callback:function(t){e.capacity=t},expression:"capacity"}})],1)],1),e._v(" "),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.closeDialog("extend")}}},[e._v(e._s(e.$t("chubaoFS.tools.Cancel")))]),e._v(" "),t("el-button",{attrs:{type:"primary"},on:{click:e.extendVolume}},[e._v(e._s(e.$t("chubaoFS.tools.Extend")))])],1)],1),e._v(" "),t("el-dialog",{attrs:{visible:e.permissionDialog,title:"卷"+e.permissionItem.name+"的权限管理",width:"35%"},on:{"update:visible":function(t){e.permissionDialog=t}}},[t("el-button",{attrs:{type:"primary"},on:{click:e.openGrantPermission}},[e._v("授权 ")]),e._v(" "),t("el-table",{staticClass:"mt10",staticStyle:{width:"100%"},attrs:{data:e.permissionList}},[t("el-table-column",{attrs:{prop:"userID",label:e.$t("chubaoFS.commonAttr.UserName")}}),e._v(" "),t("el-table-column",{attrs:{prop:"access",label:e.$t("chubaoFS.tools.Access")}}),e._v(" "),t("el-table-column",{attrs:{prop:"userID",label:"所有者"}})],1)],1),e._v(" "),t("el-dialog",{attrs:{title:e.$t("chubaoFS.volume.GrantPermissionto"),visible:e.grantPermissionDialog,width:"35%"},on:{"update:visible":function(t){e.grantPermissionDialog=t},close:function(t){return e.closeDialog("grantPer")}}},[t("el-form",{ref:"grantPermissionForm",attrs:{"label-position":e.labelPosition,model:e.grantPermissionForm,rules:e.permissionRules}},[t("el-form-item",{attrs:{label:e.$t("chubaoFS.commonAttr.UserName"),prop:"userName"}},[t("el-input",{model:{value:e.grantPermissionForm.userName,callback:function(t){e.$set(e.grantPermissionForm,"userName",t)},expression:"grantPermissionForm.userName"}})],1),e._v(" "),t("el-form-item",{attrs:{label:e.$t("chubaoFS.tools.Access"),prop:"access"}},[t("el-select",{staticStyle:{width:"100%"},model:{value:e.grantPermissionForm.access,callback:function(t){e.$set(e.grantPermissionForm,"access",t)},expression:"grantPermissionForm.access"}},e._l(e.accessList,(function(e){return t("el-option",{key:e,attrs:{value:e,label:e}})})),1)],1)],1),e._v(" "),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.closeDialog("grantPer")}}},[e._v(e._s(e.$t("chubaoFS.tools.No")))]),e._v(" "),t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.grantPermission("grantPermissionForm")}}},[e._v(e._s(e.$t("chubaoFS.tools.Yes")))])],1)],1),e._v(" "),t("el-dialog",{attrs:{title:e.$t("chubaoFS.volume.EditUserAccess"),visible:e.editPermissionDialog,width:"35%"},on:{"update:visible":function(t){e.editPermissionDialog=t}}},[t("el-form",{ref:"grantPermissionForm",attrs:{"label-position":e.labelPosition,model:e.editPermissionForm}},[t("el-form-item",{attrs:{label:e.$t("chubaoFS.commonAttr.UserName"),prop:"userName"}},[t("el-input",{attrs:{disabled:""},model:{value:e.editPermissionForm.userID,callback:function(t){e.$set(e.editPermissionForm,"userID",t)},expression:"editPermissionForm.userID"}})],1),e._v(" "),t("el-form-item",{attrs:{label:e.$t("chubaoFS.tools.Access"),prop:"access"}},[t("el-select",{staticStyle:{width:"100%"},model:{value:e.editPermissionForm.access,callback:function(t){e.$set(e.editPermissionForm,"access",t)},expression:"editPermissionForm.access"}},e._l(e.accessList,(function(e,o){return t("el-option",{key:o,attrs:{value:o,label:e}})})),1)],1)],1),e._v(" "),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.closeDialog("editPer")}}},[e._v(e._s(e.$t("chubaoFS.tools.No")))]),e._v(" "),t("el-button",{attrs:{type:"primary"},on:{click:e.editPermission}},[e._v(e._s(e.$t("chubaoFS.tools.Yes")))])],1)],1),e._v(" "),t("password",{ref:"password",on:{doSubmit:e.validPassWord}})],1)},s=[],n=(o(6203),o(70560),o(64043),o(7409),o(21057),o(77823)),r=o(78985),i=(o(69092),{name:"volumeList",components:{password:r.Z},data:function(){return{row:{},zoneList:[],labelPosition:"top",searchVal:"",page:{pageSizes:[10,20,30,40],pageNo:1,pageSize:10,total:0,totalPage:1},resData:{loading:!0,resLists:[]},volumeList:[],accessKey:"",secretKey:"",totalCapacity:null,accessKeysDialog:!1,volumeInfoDialog:!1,notesDialog:!1,editVolumeDialog:!1,createVolumeDialog:!1,volumeExtensionDialog:!1,permissionDialog:!1,grantPermissionDialog:!1,editPermissionDialog:!1,editVolumeForm:{},createVolumeForm:{name:"",totalCapacity:null,dpReplicaNum:null,owner:"",zone:[],notes:""},userID:null,dpReplicaNumList:["2","3"],capacity:null,rules:{dpReplicaNum:[{required:!0,message:this.$t("chubaoFS.volume.dpReplicaNumMsg"),trigger:"change"}],notes:[{required:!0,message:this.$t("chubaoFS.volume.notesMsg"),trigger:"blur"}]},permissionList:[],editRow:{},grantPermissionForm:{userName:"",access:""},editPermissionForm:{},volName:"",accessList:this.$t("chubaoFS.accessList"),permissionRules:{userName:[{required:!0,message:this.$t("chubaoFS.volume.userNameMsg"),trigger:"blur"}],access:[{required:!0,message:this.$t("chubaoFS.volume.accessMsg"),trigger:"change"}]},permissionItem:{name:""},accessItem:null,description:"",desContent:""}},methods:{initPage:function(){this.queryVolumeList("reset")},queryZoneList:function(e){var t=this,o={cluster:this.$route.query.clusterName};this.apollo.query(this.url.consoleCluster,n.Z.zoneList,o).then((function(e){e.data?t.zoneList=e.data.zoneList:t.$message.error(e)})).catch((function(e){t.resData.loading=!1,t.$Message.error(e)}))},handleSizeChange:function(e){this.page.pageSize=e,this.queryVolumeList()},handleCurrentChange:function(e){this.page.pageNo=e,this.page.pageSize=1,this.queryVolumeList()},getUserInfo:function(){var e=this,t={cluster:this.$route.query.clusterName,userID:this.accessItem.owner,name:this.accessItem.name};this.apollo.query(this.url.volume,n.Z.getKeys,t).then((function(t){t.data&&(e.accessKey=t.data.getKeys.access_key,e.secretKey=t.data.getKeys.secret_key)})).catch((function(t){e.resData.loading=!1,e.$Message.error(t)}))},queryVolumeList:function(e){var t=this;if(this.$route.query.clusterName&&""!=this.$route.query.clusterName){e&&"reset"==e&&(this.page.pageNo=1,this.page.pageSize=10),this.resData.loading=!0;var o={cluster:this.$route.query.clusterName,name:this.searchVal,page:this.page.pageNo,pageSize:this.page.pageSize};this.apollo.query(this.url.volume,n.Z.queryVolumeList,o).then((function(e){t.resData.loading=!1,e.data?(t.resData.resLists=e.data.listVolume.data,t.page.total=e.data.listVolume.total):t.$message.error(e)})).catch((function(e){t.resData.loading=!1,t.$Message.error(e)}))}},createVolume:function(e){var t=this;this.$refs[e].validate((function(e){if(!e)return!1;var o={cluster:t.$route.query.clusterName,capacity:parseInt(t.createVolumeForm.totalCapacity),name:t.createVolumeForm.name,owner:t.createVolumeForm.owner,zone:t.createVolumeForm.zone.join(","),description:t.createVolumeForm.notes};t.apollo.mutation(t.url.volume,n.Z.createVolume,o).then((function(e){e&&e.data&&0===e.data.createVolume.code?(t.createVolumeDialog=!1,t.queryVolumeList(),t.$message({message:t.$t("chubaoFS.message.Success"),type:"success"})):t.$message.error(e)}))}))},updateVolume:function(){var e=this,t={cluster:this.$route.query.clusterName,authKey:this.md5(this.editVolumeForm.owner)};Object.assign(t,this.editVolumeForm),this.apollo.mutation(this.url.volume,n.Z.updateVolume,t).then((function(t){t.data?(e.queryVolumeList(),e.editVolumeDialog=!1,e.$message({message:e.$t("chubaoFS.message.Success"),type:"success"})):e.$message.error(t)}))},extendVolume:function(){var e=this,t={cluster:this.$route.query.clusterName,authKey:this.md5(this.editVolumeForm.owner),name:this.editVolumeForm.name,capacity:parseInt(this.capacity)};this.apollo.mutation(this.url.volume,n.Z.updateVolume,t).then((function(t){t.data?(e.queryVolumeList(),e.capacity=null,e.volumeExtensionDialog=!1,e.$message({message:e.$t("chubaoFS.message.Success"),type:"success"})):e.$message.error(t)}))},deleteVolume:function(e){this.$refs["password"].showPassWord(),this.row=e},validPassWord:function(){var e=this,t={cluster:this.$route.query.clusterName,authKey:this.md5(this.row.owner),name:this.row.name};this.apollo.mutation(this.url.volume,n.Z.deleteVolume,t).then((function(t){t.data?(e.queryVolumeList(),e.$message({message:e.$t("chubaoFS.message.Success"),type:"success"})):e.$message.error(t)}))},queryPermissionList:function(e){var t=this;this.resData.loading=!0;var o={name:this.permissionItem.name,cluster:this.$route.query.clusterName},a={userID:this.grantPermissionForm.userName,permission:this.grantPermissionForm.access};e&&Object.assign(o,a),this.apollo.query(this.url.volume,n.Z.queryPermissionList,o).then((function(e){t.resData.loading=!1,e&&e.data?(t.permissionList=e.data.volPermission,t.grantPermissionDialog=!1):(t.permissionList=[],t.$message.error(e))}))},grantPermission:function(e){var t=this;this.$refs[e].validate((function(e){if(!e)return!1;t.queryPermissionList(!0)}))},editPermission:function(){var e=this,t={cluster:this.$route.query.clusterName,policy:[this.editPermissionForm.access],userID:this.editPermissionForm.userID,volume:this.permissionItem.name};this.apollo.mutation(this.url.user,n.Z.grantPermission,t).then((function(t){200===t.code?(e.editPermissionDialog=!1,e.queryPermissionList(),e.$message({message:e.$t("chubaoFS.message.Success"),type:"success"})):e.$message.error(t)}))},deletePermission:function(e){var t=this,o={cluster:this.$route.query.clusterName,userID:e.userID,volume:this.permissionItem.name};this.$confirm(this.$t("chubaoFS.operations.VolumeManagement.deletePermTip"),this.$t("chubaoFS.tools.Warning"),{confirmButtonText:this.$t("chubaoFS.tools.Yes"),cancelButtonText:this.$t("chubaoFS.tools.No"),type:"warning"}).then((function(){t.apollo.mutation(t.url.user,n.Z.deletePermission,o).then((function(e){200===e.code?(t.queryPermissionList(),t.$message({message:t.$t("chubaoFS.message.Success"),type:"success"})):t.$message.error(e)}))})).catch((function(){}))},openGrantPermission:function(){this.grantPermissionDialog=!0},openEditPermission:function(e){this.editPermissionDialog=!0,this.editPermissionForm=Object.assign({},e),this.editPermissionForm.access=this.editPermissionForm.access.join(",")},goDepot:function(e){this.$router.push({name:"depot",query:{clusterName:this.$route.query.clusterName,volumeName:e.name}})},goDetail:function(e){this.$router.push({name:"volumeDetail",query:{clusterName:this.$route.query.clusterName,volumeName:e.name}})},queryVolume:function(e){var t=this,o={cluster:this.$route.query.clusterName,name:e};this.apollo.query(this.url.volume,n.Z.getVolume,o).then((function(e){e.data?t.editVolumeForm=e.data.getVolume:t.$message.error(e)})).catch((function(e){t.resData.loading=!1,t.$Message.error(e)}))},openDialog:function(e,t){"accessKeys"===e&&(this.accessKeysDialog=!0,this.accessItem=t,this.getUserInfo()),"createVolume"===e&&(this.createVolumeDialog=!0,this.queryZoneList()),"edit"===e&&(this.editVolumeDialog=!0,this.editRow=t,this.queryVolume(t.name)),"extend"===e&&(this.volumeExtensionDialog=!0,this.editVolumeForm=Object.assign({},t)),"permission"===e&&(this.permissionItem=t,this.permissionDialog=!0,this.queryPermissionList()),"depot"===e&&(this.depotDialog=!0,this.permissionItem=t,this.queryPermissionList())},closeDialog:function(e){"create"===e&&(this.createVolumeDialog=!1,this.createVolumeForm={},this.$refs["createVolumeForm"].resetFields()),"extend"===e&&(this.volumeExtensionDialog=!1,this.capacity=null),"grantPer"===e&&(this.grantPermissionDialog=!1,this.grantPermissionForm={},this.$refs["grantPermissionForm"].resetFields()),"editPer"===e&&(this.editPermissionDialog=!1)},checkNumber:function(e,t,o){if(!/(^[1-9]\d*$)/.test(t))return o(new Error(this.$t("chubaoFS.enterRules.checkNumberTip")));o()},checkVolName:function(e,t,o){if(!/(^[a-z0-9]{1}[a-z0-9\\-]{1,61}[a-z0-9]$)/.test(t))return o(new Error(this.$t("chubaoFS.operations.VolumeManagement.checkVolNameTip")));o()},checkOwnerId:function(e,t,o){if(!/(^[A-Za-z][A-Za-z0-9_]{0,20}$)/.test(t))return o(new Error(this.$t("chubaoFS.operations.VolumeManagement.checkOwnerIdTip")));o()}},mounted:function(){this.userID=sessionStorage.getItem("access_userID"),this.queryVolumeList()}}),l=i,u=o(1001),c=(0,u.Z)(l,a,s,!1,null,"47cfed9f",null),m=c.exports},63477:function(e,t,o){var a=o(22615),s=o(36812),n=o(23622),r=o(69633),i=RegExp.prototype;e.exports=function(e){var t=e.flags;return void 0!==t||"flags"in i||s(e,"flags")||!n(i,e)?t:a(r,e)}},6203:function(e,t,o){var a=o(79989),s=o(68844),n=o(94413),r=o(65290),i=o(16834),l=s([].join),u=n!==Object,c=u||!i("join",",");a({target:"Array",proto:!0,forced:c},{join:function(e){return l(r(this),void 0===e?",":e)}})},7409:function(e,t,o){o(64043);var a=o(79989),s=o(22615),n=o(69985),r=o(85027),i=o(34327),l=function(){var e=!1,t=/[ac]/;return t.exec=function(){return e=!0,/./.exec.apply(this,arguments)},!0===t.test("abc")&&e}(),u=/./.test;a({target:"RegExp",proto:!0,forced:!l},{test:function(e){var t=r(this),o=i(e),a=t.exec;if(!n(a))return s(u,t,o);var l=s(a,t,o);return null!==l&&(r(l),!0)}})},12826:function(e,t,o){var a=o(41236).PROPER,s=o(11880),n=o(85027),r=o(34327),i=o(3689),l=o(63477),u="toString",c=RegExp.prototype,m=c[u],p=i((function(){return"/a/b"!==m.call({source:"a",flags:"b"})})),d=a&&m.name!==u;(p||d)&&s(RegExp.prototype,u,(function(){var e=n(this),t=r(e.source),o=r(l(e));return"/"+t+"/"+o}),{unsafe:!0})}}]);