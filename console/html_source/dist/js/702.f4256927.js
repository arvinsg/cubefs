"use strict";(self["webpackJsonp_cfs-console"]=self["webpackJsonp_cfs-console"]||[]).push([[702],{94702:function(e,t,s){s.r(t),s.d(t,{default:function(){return b}});s(59749),s(86544);var r,a,o,i,n=function(){var e=this,t=e._self._c;return t("div",{staticClass:"cluster author"},[t("div",[t("div",{staticClass:"volume-left"},[t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.openDialog("add")}}},[e._v(e._s(e.$t("chubaoFS.authorization.AddUser")))])],1),e._v(" "),t("div",{staticClass:"volume-right"},[t("el-input",{staticStyle:{width:"255px"},attrs:{placeholder:""},model:{value:e.searchVal,callback:function(t){e.searchVal=t},expression:"searchVal"}}),e._v(" "),t("el-button",{staticClass:"ml5",attrs:{type:"primary"},on:{click:e.queryUserList}},[e._v(e._s(e.$t("chubaoFS.tools.Search")))])],1)]),e._v(" "),t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.resData.loading,expression:"resData.loading"}],staticClass:"data-block"},[t("el-table",{staticClass:"mt20",staticStyle:{width:"100%"},attrs:{data:e.resData.resLists}},[t("el-table-column",{attrs:{prop:"user_id",label:e.$t("chubaoFS.authorization.detail.UserName")}}),e._v(" "),t("el-table-column",{attrs:{prop:"userTypeStr",label:e.$t("chubaoFS.authorization.detail.UserType")}}),e._v(" "),t("el-table-column",{attrs:{prop:"description",label:e.$t("chubaoFS.authorization.detail.Comments")}}),e._v(" "),t("el-table-column",{attrs:{label:e.$t("chubaoFS.tools.Actions")},scopedSlots:e._u([{key:"default",fn:function(s){return[t("el-button",{staticClass:"text-btn",attrs:{type:"text"},on:{click:function(t){return e.openDialog("edit",s.row)}}},[e._v(e._s(e.$t("chubaoFS.tools.Edit")))]),e._v(" "),t("el-button",{staticClass:"text-btn",attrs:{type:"text"},on:{click:function(t){return e.openDialog("delete",s.row)}}},[e._v(e._s(e.$t("chubaoFS.tools.Delete")))])]}}])})],1),e._v(" "),t("div",{staticClass:"clearfix mt20"},[t("el-pagination",{staticClass:"fr",attrs:{"page-sizes":e.resData.page.pageSizes,"page-size":e.resData.page.pageSize,layout:"sizes, prev, pager, next",total:e.resData.page.totalRecord},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}),e._v(" "),t("span",{staticClass:"fr page-tips pr10"},[e._v(e._s(e.$t("chubaoFS.commonTxt.eachPageShows")))])],1)],1),e._v(" "),t("el-dialog",{attrs:{title:e.$t("chubaoFS.authorization.actions.AddNewUser"),visible:e.addUserDialog,width:"30%"},on:{"update:visible":function(t){e.addUserDialog=t},close:e.closeDialog}},[t("el-form",{ref:"addUserForm",attrs:{"label-position":e.labelPosition,model:e.addUserForm,rules:e.rules}},[t("el-form-item",{attrs:{label:e.$t("chubaoFS.authorization.actions.UserName"),prop:"userName",rules:[{required:!0,message:e.$t("chubaoFS.volume.userNameMsg"),trigger:"blur"},{validator:e.checkUserName,message:e.$t("chubaoFS.authorization.tips.checkUserNameMsg"),trigger:"blur"}]}},[t("el-input",{model:{value:e.addUserForm.userName,callback:function(t){e.$set(e.addUserForm,"userName",t)},expression:"addUserForm.userName"}})],1),e._v(" "),t("el-form-item",{attrs:{label:e.$t("chubaoFS.authorization.actions.SetPassword"),prop:"password",rules:[{required:!0,message:e.$t("chubaoFS.authorization.tips.SetPasswordMsg"),trigger:"blur"},{validator:e.checkPassword,message:e.$t("chubaoFS.authorization.tips.checkPasswordMsg"),trigger:"blur"}]}},[t("el-input",{attrs:{"show-password":""},model:{value:e.addUserForm.password,callback:function(t){e.$set(e.addUserForm,"password",t)},expression:"addUserForm.password"}})],1),e._v(" "),t("el-form-item",{attrs:{label:e.$t("chubaoFS.authorization.actions.ConfirmPassword"),prop:"confirmPassword",rules:[{required:!0,message:e.$t("chubaoFS.authorization.tips.confirmPasswordMsg1"),trigger:"blur"},{validator:e.confirmPassword,message:e.$t("chubaoFS.authorization.tips.confirmPasswordMsg2"),trigger:"blur"}]}},[t("el-input",{attrs:{"show-password":""},model:{value:e.addUserForm.confirmPassword,callback:function(t){e.$set(e.addUserForm,"confirmPassword",t)},expression:"addUserForm.confirmPassword"}})],1),e._v(" "),t("el-form-item",{attrs:{label:e.$t("chubaoFS.authorization.actions.Type"),prop:"type"}},[t("el-select",{staticStyle:{width:"100%"},model:{value:e.addUserForm.type,callback:function(t){e.$set(e.addUserForm,"type",t)},expression:"addUserForm.type"}},e._l(e.typeList,(function(e){return t("el-option",{key:e.value,attrs:{value:e.value,label:e.label}})})),1)],1),e._v(" "),t("el-form-item",{attrs:{label:e.$t("chubaoFS.authorization.actions.Comments")}},[t("el-input",{attrs:{type:"textarea"},model:{value:e.addUserForm.comments,callback:function(t){e.$set(e.addUserForm,"comments",t)},expression:"addUserForm.comments"}})],1)],1),e._v(" "),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:e.closeDialog}},[e._v(e._s(e.$t("chubaoFS.tools.No")))]),e._v(" "),t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.addUser("addUserForm")}}},[e._v(e._s(e.$t("chubaoFS.tools.Yes")))])],1)],1),e._v(" "),t("el-dialog",{attrs:{title:e.$t("chubaoFS.authorization.actions.EditUserAuthorization"),visible:e.editUserDialog,width:"30%"},on:{"update:visible":function(t){e.editUserDialog=t}}},[t("el-form",{attrs:{"label-position":e.labelPosition,model:e.editUserForm,rules:e.rules}},[t("el-form-item",{attrs:{label:e.$t("chubaoFS.authorization.actions.UserName")}},[t("el-input",{attrs:{disabled:""},model:{value:e.editUserForm.user_id,callback:function(t){e.$set(e.editUserForm,"user_id",t)},expression:"editUserForm.user_id"}})],1),e._v(" "),t("el-form-item",{attrs:{label:e.$t("chubaoFS.authorization.actions.NewPassword"),prop:"password",rules:[{validator:e.checkPassword,message:e.$t("chubaoFS.authorization.tips.checkPasswordMsg"),trigger:"blur"}]}},[t("el-input",{attrs:{"show-password":""},model:{value:e.editUserForm.password,callback:function(t){e.$set(e.editUserForm,"password",t)},expression:"editUserForm.password"}})],1),e._v(" "),t("el-form-item",{attrs:{label:e.$t("chubaoFS.authorization.actions.ConfirmNewPassword"),prop:"confirmPassword",rules:[{validator:e.confirmNewPassword,message:e.$t("chubaoFS.authorization.tips.confirmPasswordMsg2"),trigger:"blur"}]}},[t("el-input",{attrs:{"show-password":""},model:{value:e.editUserForm.confirmPassword,callback:function(t){e.$set(e.editUserForm,"confirmPassword",t)},expression:"editUserForm.confirmPassword"}})],1),e._v(" "),t("el-form-item",{attrs:{label:e.$t("chubaoFS.authorization.actions.Type")}},[t("el-select",{staticStyle:{width:"100%"},model:{value:e.editUserForm.user_type,callback:function(t){e.$set(e.editUserForm,"user_type",t)},expression:"editUserForm.user_type"}},e._l(e.typeList,(function(e){return t("el-option",{key:e.value,attrs:{value:e.value,label:e.label}})})),1)],1),e._v(" "),t("el-form-item",{attrs:{label:e.$t("chubaoFS.authorization.actions.Comments")}},[t("el-input",{attrs:{type:"textarea"},model:{value:e.editUserForm.description,callback:function(t){e.$set(e.editUserForm,"description",t)},expression:"editUserForm.description"}})],1)],1),e._v(" "),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.editUserDialog=!1}}},[e._v(e._s(e.$t("chubaoFS.tools.No")))]),e._v(" "),t("el-button",{attrs:{type:"primary"},on:{click:e.updateUser}},[e._v(e._s(e.$t("chubaoFS.tools.Yes")))])],1)],1),e._v(" "),t("el-dialog",{attrs:{title:e.$t("chubaoFS.tools.Delete"),visible:e.deleteUserDialog,width:"30%"},on:{"update:visible":function(t){e.deleteUserDialog=t}}},[t("div",{staticClass:"delete-tip"},[t("i",{staticClass:"warn"},[t("img",{attrs:{src:s(93351),alt:""}})]),e._v("\n      "+e._s(e.$t("chubaoFS.authorization.tips.delTip"))+"\n    ")]),e._v(" "),t("el-form",{attrs:{"label-position":e.labelPosition,model:e.editUserForm}},[t("el-form-item",{attrs:{label:e.$t("chubaoFS.authorization.actions.UserName")}},[t("el-input",{attrs:{disabled:""},model:{value:e.editUserForm.user_id,callback:function(t){e.$set(e.editUserForm,"user_id",t)},expression:"editUserForm.user_id"}})],1),e._v(" "),t("el-form-item",{attrs:{label:e.$t("chubaoFS.authorization.actions.Comments")}},[t("el-input",{attrs:{type:"textarea",disabled:""},model:{value:e.editUserForm.description,callback:function(t){e.$set(e.editUserForm,"description",t)},expression:"editUserForm.description"}})],1),e._v(" "),t("el-form-item",{attrs:{label:e.$t("chubaoFS.authorization.actions.Type")}},[t("el-select",{staticStyle:{width:"100%"},attrs:{disabled:""},model:{value:e.editUserForm.userTypeStr,callback:function(t){e.$set(e.editUserForm,"userTypeStr",t)},expression:"editUserForm.userTypeStr"}},e._l(e.typeList,(function(e){return t("el-option",{key:e.value,attrs:{value:e.value,label:e.label}})})),1)],1)],1),e._v(" "),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.deleteUserDialog=!1}}},[e._v(e._s(e.$t("chubaoFS.tools.No")))]),e._v(" "),t("el-button",{attrs:{type:"primary"},on:{click:e.deleteUser}},[e._v(e._s(e.$t("chubaoFS.tools.Yes")))])],1)],1)],1)},l=[],u=(s(89730),s(28436),s(60228),s(47522),s(70560),s(65137),s(64043),s(7409),s(21057),s(2106)),c=s(4969),d={queryUserList:(0,c.ZP)(r||(r=(0,u.Z)(["query ListUserInfo {\n      listUserInfo{\n        user_id\n        user_type\n        description\n      }\n    }"]))),createUser:(0,c.ZP)(a||(a=(0,u.Z)(["mutation CreateUser($accessKey:String, $iD:String, $password:String,$secretKey:String,$type:Uint8, $description:String) {\n      createUser(accessKey:$accessKey, iD:$iD, password:$password,secretKey:$secretKey,type:$type, description:$description){\n        user_id\n      }\n    }"]))),updateUser:(0,c.ZP)(o||(o=(0,u.Z)(["mutation updateUser($accessKey:String, $userID:String, $secretKey:String, $type:Uint8, $description:String, $password:String) {\n      updateUser(accessKey:$accessKey, userID:$userID, secretKey:$secretKey, type:$type, description:$description, password:$password){\n        user_id\n      }\n    }"]))),deleteUser:(0,c.ZP)(i||(i=(0,u.Z)(["mutation deleteUser($userID:String) {\n      deleteUser(userID:$userID){\n        code\n      }\n    }"])))},p=d,m={name:"authorization",data:function(){return{labelPosition:"top",searchVal:"",resData:{loading:!0,page:{pageSizes:[10,20,30,40],pageNo:1,pageSize:10,totalRecord:0,totalPage:1},resLists:[]},userInfoList:[],volumeName:"",addUserDialog:!1,editUserDialog:!1,deleteUserDialog:!1,addUserForm:{userName:"",password:"",confirmPassword:"",comments:"",type:null},typeList:[{value:"2",label:"admin"},{value:"3",label:"user"}],editUserForm:{password:"",confirmPassword:""},rules:{type:[{required:!0,message:this.$t("chubaoFS.authorization.tips.typeMsg"),trigger:"change"}]}}},computed:{crumbInfo:function(){return this.volumeName}},methods:{handleSizeChange:function(e){this.resData.page.pageSize=e,this.resData.page.pageNo=1,this.handleCurrentChange(1)},handleCurrentChange:function(e){this.resData.page.pageNo=e;var t=(e-1)*this.resData.page.pageSize,s=e*this.resData.page.pageSize;this.resData.resLists=this.userInfoList.slice(t,s)},queryUserList:function(){var e=this,t=this;t.resData.loading=!0;var s={num:1e4};this.apollo.query(this.url.authorization,p.queryUserList,s).then((function(s){if(t.resData.loading=!1,s.data){var r=[];e.searchVal&&""!==e.searchVal.trim()?s.data.listUserInfo.forEach((function(t){t.user_id.indexOf(e.searchVal.trim())>-1&&r.push(t)})):r=s.data.listUserInfo,r.sort((function(e,t){return e.user_id.charCodeAt(0)-t.user_id.charCodeAt(0)})).sort((function(e,t){return e.user_type-t.user_type})),e.userInfoList=r,e.userInfoList.forEach((function(e){1===e.user_type&&(e.userTypeStr="root"),2===e.user_type&&(e.userTypeStr="admin"),3===e.user_type&&(e.userTypeStr="user")})),e.resData.page.totalRecord=e.userInfoList.length,e.handleCurrentChange(1)}else e.$message.error(s.message)})).catch((function(){t.resData.loading=!1}))},addUser:function(e){var t=this;this.$refs[e].validate((function(e){if(!e)return!1;var s={accessKey:"",iD:t.addUserForm.userName,password:t.addUserForm.password,secretKey:"",description:t.addUserForm.comments||"",type:parseInt(t.addUserForm.type)};t.apollo.mutation(t.url.authorization,p.createUser,s).then((function(e){200===e.code?(t.queryUserList(),t.addUserDialog=!1,t.addUserForm={},t.$message({message:t.$t("chubaoFS.message.Success"),type:"success"})):t.$message.error(e.message)})).catch((function(e){t.resData.loading=!1,console.log(e)}))}))},updateUser:function(){var e=this;if(this.editUserForm.password===this.editUserForm.confirmPassword){var t={accessKey:"",secretKey:"",password:this.editUserForm.password||"",userID:this.editUserForm.user_id,description:this.editUserForm.description,type:parseInt(this.editUserForm.user_type)};this.apollo.mutation(this.url.authorization,p.updateUser,t).then((function(t){200===t.code?(e.queryUserList(),e.editUserDialog=!1,e.$message({message:e.$t("chubaoFS.message.Success"),type:"success"})):e.$message.error(t.message)}))}else this.$message({message:this.$t("chubaoFS.authorization.tips.confirmPasswordMsg2"),type:"warning"})},deleteUser:function(){var e=this,t={userID:this.editUserForm.user_id};this.apollo.mutation(this.url.authorization,p.deleteUser,t).then((function(t){200===t.code?(e.queryUserList(),e.deleteUserDialog=!1,e.$message({message:e.$t("chubaoFS.message.Success"),type:"success"})):e.$message.error(t.message)})).catch((function(t){e.resData.loading=!1,console.log(t)}))},openDialog:function(e,t){"add"===e&&(this.addUserDialog=!0),"edit"===e&&(this.editUserDialog=!0,this.editUserForm=Object.assign({},t),this.editUserForm.user_type=this.editUserForm.user_type+"","root"===this.editUserForm.user_id?(this.typeList=[{value:"1",label:"root"}],this.editUserForm.user_type="1",this.editUserForm.user_type.disable=!0):(this.typeList=[{value:"2",label:"admin"},{value:"3",label:"user"}],this.editUserForm.user_type.disable=!1)),"delete"===e&&(this.deleteUserDialog=!0,this.editUserForm=t)},closeDialog:function(){this.addUserDialog=!1,this.addUserForm={},this.$refs["addUserForm"].resetFields()},checkUserName:function(e,t,s){if(!/(^[A-Za-z][A-Za-z0-9_]{0,20}$)/.test(t))return s(new Error(this.$t("chubaoFS.authorization.tips.checkUserNameMsg")));s()},checkPassword:function(e,t,s){if(!/([A-Za-z0-9]{6,30}$)/.test(t))return s(new Error(this.$t("chubaoFS.authorization.tips.checkPasswordMsg")));s()},confirmPassword:function(e,t,s){if(this.addUserForm.password!==this.addUserForm.confirmPassword)return s(new Error(this.$t("chubaoFS.authorization.tips.confirmPasswordMsg2")));s()},confirmNewPassword:function(e,t,s){if(this.editUserForm.password!==this.editUserForm.confirmPassword)return s(new Error(this.$t("chubaoFS.authorization.tips.confirmPasswordMsg2")));s()}},mounted:function(){var e=this.$route.query;this.volumeName=e.volumeName,this.queryUserList()}},h=m,f=s(1001),g=(0,f.Z)(h,n,l,!1,null,"54c14cc6",null),b=g.exports},93351:function(e){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAYAAACM/rhtAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAZiS0dEAP8A/wD/oL2nkwAAAbtJREFUWMPVWb1OwzAQNiMSMDKw2qgDEjuvwaPwAkjtszSOEkBiYc0DwNYpT0AXFqoEJKSau4SaFgWRn8/BjnSqpcbnr3e+z5+vQvR83mMly1hdlVrNybJSy5w+V7VV46z6jt7hd8UYj7k7Py60nJItikiaTsZzaC77wANLzg7etLrm6HQG9sPYB/tinxBwZXx6Sb98ORRYQ0SX7Lt/1IzZq6Mm13BwNppyXUWT1uqY0ot9SkXiClhD2hNes3XkaEI6FrgdkG0iySEfG9zGeO0/C8LlnmuzJ38tHC57J9Xao7obKQiRWtpHH2zwVDO7DyZhrV4KPTmpjcYDyXznxKGwzgZHL1I3di9reQtI9XQb4AJBE98AARxKmKwqQfEYFCBZpYJYDvkKkLGxs7m3AAkbO8s8BphxxeX+ApS5QIhQhxFcCeKvV28BErYgUgwqEvloiT+ST8AiwdDMl8MUKXZrmgERtRN9yESNOuo2mxpVdPaoQ4kF8vFs7ieH5kEd8RgmFmByiySWM7nlvWD1XvIHcWny/toZxMU9iNbHVvMoHRFc2rp5FET7LYgGZjAt4IYm+sy7Jvp//g3xCU4zj6BD/PgbAAAAAElFTkSuQmCC"},50382:function(e,t,s){var r=s(9015),a=Math.floor,o=function(e,t){var s=e.length,l=a(s/2);return s<8?i(e,t):n(e,o(r(e,0,l),t),o(r(e,l),t),t)},i=function(e,t){var s,r,a=e.length,o=1;while(o<a){r=o,s=e[o];while(r&&t(e[r-1],s)>0)e[r]=e[--r];r!==o++&&(e[r]=s)}return e},n=function(e,t,s,r){var a=t.length,o=s.length,i=0,n=0;while(i<a||n<o)e[i+n]=i<a&&n<o?r(t[i],s[n])<=0?t[i++]:s[n++]:i<a?t[i++]:s[n++];return e};e.exports=o},98494:function(e,t,s){var r=s(23691),a=TypeError;e.exports=function(e,t){if(!delete e[t])throw new a("Cannot delete property "+r(t)+" of "+r(e))}},97365:function(e,t,s){var r=s(30071),a=r.match(/firefox\/(\d+)/i);e.exports=!!a&&+a[1]},37298:function(e,t,s){var r=s(30071);e.exports=/MSIE|Trident/.test(r)},27922:function(e,t,s){var r=s(30071),a=r.match(/AppleWebKit\/(\d+)\./);e.exports=!!a&&+a[1]},75984:function(e,t,s){var r=s(41236).PROPER,a=s(3689),o=s(86350),i="​᠎";e.exports=function(e){return a((function(){return!!o[e]()||i[e]()!==i||r&&o[e].name!==e}))}},65137:function(e,t,s){var r=s(79989),a=s(68844),o=s(10509),i=s(90690),n=s(6310),l=s(98494),u=s(34327),c=s(3689),d=s(50382),p=s(16834),m=s(97365),h=s(37298),f=s(3615),g=s(27922),b=[],v=a(b.sort),U=a(b.push),F=c((function(){b.sort(void 0)})),y=c((function(){b.sort(null)})),w=p("sort"),S=!c((function(){if(f)return f<70;if(!(m&&m>3)){if(h)return!0;if(g)return g<603;var e,t,s,r,a="";for(e=65;e<76;e++){switch(t=String.fromCharCode(e),e){case 66:case 69:case 70:case 72:s=3;break;case 68:case 71:s=4;break;default:s=2}for(r=0;r<47;r++)b.push({k:t+r,v:s})}for(b.sort((function(e,t){return t.v-e.v})),r=0;r<b.length;r++)t=b[r].k.charAt(0),a.charAt(a.length-1)!==t&&(a+=t);return"DGBEFHACIJK"!==a}})),$=F||!y||!w||!S,_=function(e){return function(t,s){return void 0===s?-1:void 0===t?1:void 0!==e?+e(t,s)||0:u(t)>u(s)?1:-1}};r({target:"Array",proto:!0,forced:$},{sort:function(e){void 0!==e&&o(e);var t=i(this);if(S)return void 0===e?v(t):v(t,e);var s,r,a=[],u=n(t);for(r=0;r<u;r++)r in t&&U(a,t[r]);d(a,_(e)),s=n(a),r=0;while(r<s)t[r]=a[r++];while(r<u)l(t,r++);return t}})},7409:function(e,t,s){s(64043);var r=s(79989),a=s(22615),o=s(69985),i=s(85027),n=s(34327),l=function(){var e=!1,t=/[ac]/;return t.exec=function(){return e=!0,/./.exec.apply(this,arguments)},!0===t.test("abc")&&e}(),u=/./.test;r({target:"RegExp",proto:!0,forced:!l},{test:function(e){var t=i(this),s=n(e),r=t.exec;if(!o(r))return a(u,t,s);var l=a(r,t,s);return null!==l&&(i(l),!0)}})},28436:function(e,t,s){var r=s(79989),a=s(61435).trim,o=s(75984);r({target:"String",proto:!0,forced:o("trim")},{trim:function(){return a(this)}})}}]);